(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6112],{9276:function(e,s,t){Promise.resolve().then(t.bind(t,7829))},7829:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var r=t(7437),l=t(2265),i=t(2420),n=t(6110),a=t(3023),c=t(9155),d=t(7579),o=t(4045),m=t(6141),x=t(4530),u=t(9806),h=t(8063),f=t(8203),j=t(5340),g=t(6142),v=t(7810),b=t(7972),N=t(1738),p=t(2741),y=t(1295),w=t(1396),k=t.n(w),Z=t(3160);t(5771),t(6672),t(2206);var S=t(1424),z=t(9314),B=t(5825);function C(){var e,s;let{user:t}=(0,o.tN)(),{bookings:w,setBookings:C}=(0,o.ML)(),[P,_]=(0,l.useState)({totalBookings:0,pendingBookings:0,confirmedBookings:0,completedBookings:0}),[Y,R]=(0,l.useState)(!0),[O,E]=(0,l.useState)("overview");(0,l.useEffect)(()=>{let e=async()=>{if(t)try{R(!0);let{data:e,error:s}=await (0,B.aL)(t.id,"customer");if(s){S.Am.error("Failed to fetch bookings"),console.error("Fetch bookings error:",s);return}C(e||[]);let r=(null==e?void 0:e.length)||0,l=(null==e?void 0:e.filter(e=>"pending"===e.status).length)||0,i=(null==e?void 0:e.filter(e=>"confirmed"===e.status).length)||0,n=(null==e?void 0:e.filter(e=>"completed"===e.status).length)||0;_({totalBookings:r,pendingBookings:l,confirmedBookings:i,completedBookings:n})}catch(e){console.error("Dashboard error:",e),S.Am.error("Something went wrong loading dashboard")}finally{R(!1)}};e()},[t]);let V=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"confirmed":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},A=e=>{switch(e){case"pending":return(0,r.jsx)(m.Z,{className:"h-4 w-4"});case"confirmed":case"completed":return(0,r.jsx)(x.Z,{className:"h-4 w-4"});case"cancelled":return(0,r.jsx)(u.Z,{className:"h-4 w-4"});default:return(0,r.jsx)(h.Z,{className:"h-4 w-4"})}};return Y?(0,r.jsx)(i.a,{requiredRole:"customer",children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)(Z.T,{className:"h-8 w-8"})})}):(0,r.jsx)(i.a,{requiredRole:"customer",children:(0,r.jsxs)("div",{className:"container py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Customer Dashboard"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:["Welcome back, ",(null==t?void 0:null===(e=t.user_metadata)||void 0===e?void 0:e.name)||"Customer"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ll,{className:"text-sm font-medium",children:"Total Bookings"}),(0,r.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:P.totalBookings}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"All time bookings"})]})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ll,{className:"text-sm font-medium",children:"Pending"}),(0,r.jsx)(m.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:P.pendingBookings}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Awaiting confirmation"})]})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ll,{className:"text-sm font-medium",children:"Confirmed"}),(0,r.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:P.confirmedBookings}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Ready to go"})]})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(n.ll,{className:"text-sm font-medium",children:"Completed"}),(0,r.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(n.aY,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:P.completedBookings}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Finished services"})]})]})]}),(0,r.jsxs)(d.mQ,{value:O,onValueChange:E,className:"space-y-6",children:[(0,r.jsxs)(d.dr,{className:"grid w-full grid-cols-4",children:[(0,r.jsx)(d.SP,{value:"overview",children:"Overview"}),(0,r.jsx)(d.SP,{value:"bookings",children:"My Bookings"}),(0,r.jsx)(d.SP,{value:"favorites",children:"Favorites"}),(0,r.jsx)(d.SP,{value:"profile",children:"Profile"})]}),(0,r.jsx)(d.nU,{value:"overview",className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{children:[(0,r.jsx)(n.ll,{children:"Quick Actions"}),(0,r.jsx)(n.SZ,{children:"Explore and book services"})]}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsx)(a.z,{asChild:!0,className:"w-full justify-start",children:(0,r.jsxs)(k(),{href:"/services",children:[(0,r.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Browse Services"]})}),(0,r.jsx)(a.z,{variant:"outline",asChild:!0,className:"w-full justify-start",children:(0,r.jsxs)(k(),{href:"/search",children:[(0,r.jsx)(g.Z,{className:"mr-2 h-4 w-4"}),"Search by Location"]})}),(0,r.jsx)(a.z,{variant:"outline",asChild:!0,className:"w-full justify-start",children:(0,r.jsxs)(k(),{href:"/dashboard/customer?tab=favorites",children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"}),"View Favorites"]})})]})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{children:[(0,r.jsx)(n.ll,{children:"Recent Bookings"}),(0,r.jsx)(n.SZ,{children:"Your latest booking activity"})]}),(0,r.jsx)(n.aY,{children:0===w.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(f.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"No bookings yet"}),(0,r.jsx)(a.z,{asChild:!0,children:(0,r.jsx)(k(),{href:"/services",children:"Browse Services"})})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[w.slice(0,3).map(e=>{var s;return(0,r.jsxs)("div",{className:"flex items-center space-x-4 p-3 border rounded-lg",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-medium",children:null===(s=e.listings)||void 0===s?void 0:s.title}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,z.ZP)(new Date(e.booking_date),"PPP")})]}),(0,r.jsxs)(c.C,{className:V(e.status),children:[A(e.status),(0,r.jsx)("span",{className:"ml-1 capitalize",children:e.status})]})]},e.id)}),(0,r.jsx)(a.z,{variant:"outline",asChild:!0,className:"w-full",children:(0,r.jsx)(k(),{href:"/dashboard/customer?tab=bookings",children:"View All Bookings"})})]})})]})]})}),(0,r.jsxs)(d.nU,{value:"bookings",className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"My Bookings"}),(0,r.jsx)(a.z,{asChild:!0,children:(0,r.jsxs)(k(),{href:"/services",children:[(0,r.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Book New Service"]})})]}),0===w.length?(0,r.jsx)(n.Zb,{children:(0,r.jsxs)(n.aY,{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)(f.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No bookings yet"}),(0,r.jsx)("p",{className:"text-muted-foreground text-center mb-4",children:"Start exploring our services and make your first booking"}),(0,r.jsx)(a.z,{asChild:!0,children:(0,r.jsx)(k(),{href:"/services",children:"Browse Services"})})]})}):(0,r.jsx)("div",{className:"space-y-4",children:w.map(e=>{var s,t,l,i;return(0,r.jsxs)(n.Zb,{className:"hover:shadow-lg transition-shadow",children:[(0,r.jsx)(n.Ol,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.ll,{className:"text-lg",children:null===(s=e.listings)||void 0===s?void 0:s.title}),(0,r.jsxs)(n.SZ,{children:["by ",null===(l=e.listings)||void 0===l?void 0:null===(t=l.vendors)||void 0===t?void 0:t.business_name]})]}),(0,r.jsxs)(c.C,{className:V(e.status),children:[A(e.status),(0,r.jsx)("span",{className:"ml-1 capitalize",children:e.status})]})]})}),(0,r.jsxs)(n.aY,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center text-sm",children:[(0,r.jsx)(f.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,r.jsx)("span",{children:(0,z.ZP)(new Date(e.booking_date),"PPP")})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,r.jsx)("span",{children:e.booking_time})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm",children:[(0,r.jsx)(b.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,r.jsxs)("span",{children:[e.guests," guest",e.guests>1?"s":""]})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm",children:[(0,r.jsx)(N.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,r.jsxs)("span",{children:["â‚¦",null===(i=e.total_amount)||void 0===i?void 0:i.toLocaleString()]})]})]}),e.special_requests&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h5",{className:"font-medium text-sm mb-1",children:"Special Requests:"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:e.special_requests})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(p.Z,{className:"h-3 w-3 mr-1"}),(0,r.jsx)("span",{children:e.contact_phone})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(y.Z,{className:"h-3 w-3 mr-1"}),(0,r.jsx)("span",{children:e.contact_email})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:["completed"===e.status&&(0,r.jsxs)(a.z,{variant:"outline",size:"sm",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4 mr-1"}),"Review"]}),"pending"===e.status&&(0,r.jsx)(a.z,{variant:"outline",size:"sm",children:"Cancel"}),(0,r.jsx)(a.z,{variant:"outline",size:"lg",asChild:!0,className:"bg-purple-600 hover:bg-purple-700 text-white",children:(0,r.jsx)(k(),{href:"/payments?booking=".concat(e.id,"&reference=").concat(e.payment_reference),children:"Pay now"})})]})]})]})]},e.id)})})]}),(0,r.jsxs)(d.nU,{value:"favorites",className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Favorite Services"}),(0,r.jsx)(n.Zb,{children:(0,r.jsxs)(n.aY,{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)(v.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No favorites yet"}),(0,r.jsx)("p",{className:"text-muted-foreground text-center mb-4",children:"Save services you love to easily find them later"}),(0,r.jsx)(a.z,{asChild:!0,children:(0,r.jsx)(k(),{href:"/services",children:"Browse Services"})})]})})]}),(0,r.jsxs)(d.nU,{value:"profile",className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Profile Settings"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{children:[(0,r.jsx)(n.ll,{children:"Personal Information"}),(0,r.jsx)(n.SZ,{children:"Update your account details"})]}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Name"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:null==t?void 0:null===(s=t.user_metadata)||void 0===s?void 0:s.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Email"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:null==t?void 0:t.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Role"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Customer"})]}),(0,r.jsx)(a.z,{variant:"outline",children:"Edit Profile"})]})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{children:[(0,r.jsx)(n.ll,{children:"Account Settings"}),(0,r.jsx)(n.SZ,{children:"Manage your preferences"})]}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm",children:"Email notifications"}),(0,r.jsx)(a.z,{variant:"outline",size:"sm",children:"Enable"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm",children:"SMS notifications"}),(0,r.jsx)(a.z,{variant:"outline",size:"sm",children:"Enable"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm",children:"Marketing emails"}),(0,r.jsx)(a.z,{variant:"outline",size:"sm",children:"Disable"})]})]})]})]})]})]})]})})}},2420:function(e,s,t){"use strict";t.d(s,{a:function(){return c}});var r=t(7437),l=t(2265),i=t(4033),n=t(4045),a=t(3160);function c(e){let{children:s,requiredRole:t=null}=e,{user:c,loading:d}=(0,n.tN)(),[o,m]=(0,l.useState)(!0),x=(0,i.useRouter)();return((0,l.useEffect)(()=>{let e=setTimeout(()=>{var e;if(!c){x.push("/login");return}if(t&&(null===(e=c.user_metadata)||void 0===e?void 0:e.role)!==t){x.push("/unauthorized");return}m(!1)},100);return()=>clearTimeout(e)},[c,x,t]),d||o)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)(a.T,{className:"h-8 w-8"})}):c?(0,r.jsx)(r.Fragment,{children:s}):null}},9155:function(e,s,t){"use strict";t.d(s,{C:function(){return a}});var r=t(7437);t(2265);var l=t(9213),i=t(9311);let n=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function a(e){let{className:s,variant:t,...l}=e;return(0,r.jsx)("div",{className:(0,i.cn)(n({variant:t}),s),...l})}},6672:function(e,s,t){"use strict";t.d(s,{_:function(){return d}});var r=t(7437),l=t(2265),i=t(6743),n=t(9213),a=t(9311);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,r.jsx)(i.f,{ref:s,className:(0,a.cn)(c(),t),...l})});d.displayName=i.f.displayName},7579:function(e,s,t){"use strict";t.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return a},nU:function(){return o}});var r=t(7437),l=t(2265),i=t(4522),n=t(9311);let a=i.fC,c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,r.jsx)(i.aV,{ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...l})});c.displayName=i.aV.displayName;let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,r.jsx)(i.xz,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...l})});d.displayName=i.xz.displayName;let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,r.jsx)(i.VY,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});o.displayName=i.VY.displayName},5771:function(e,s,t){"use strict";t.d(s,{g:function(){return n}});var r=t(7437),l=t(2265),i=t(9311);let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});n.displayName="Textarea"}},function(e){e.O(0,[7533,4724,2294,1424,1127,4931,4879,1181,2971,7864,1744],function(){return e(e.s=9276)}),_N_E=e.O()}]);