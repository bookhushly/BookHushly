(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6193],{9315:function(e,s,t){Promise.resolve().then(t.bind(t,5025))},2420:function(e,s,t){"use strict";t.d(s,{a:function(){return c}});var a=t(7437),r=t(2265),i=t(4033),n=t(4045),l=t(3160);function c(e){let{children:s,requiredRole:t=null}=e,{user:c,loading:o}=(0,n.tN)(),[d,u]=(0,r.useState)(!0),m=(0,i.useRouter)();return((0,r.useEffect)(()=>{let e=setTimeout(()=>{var e;if(!c){m.push("/login");return}if(t&&(null===(e=c.user_metadata)||void 0===e?void 0:e.role)!==t){m.push("/unauthorized");return}u(!1)},100);return()=>clearTimeout(e)},[c,m,t]),o||d)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)(l.T,{className:"h-8 w-8"})}):c?(0,a.jsx)(a.Fragment,{children:s}):null}},5025:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return T}});var a=t(7437),r=t(2265),i=t(4033),n=t(1396),l=t.n(n),c=t(2420),o=t(4045),d=t(5825),u=t(3067),m=t(8063),x=t(8203),h=t(6141),f=t(5750),p=t(4530),g=t(6142),j=t(1738),y=t(9314),v=t(9311),b=t(1424),N=t(6110),_=t(2206),w=t(957),k=t(5050),P=t(5831),S=t(3023),Z=t(1291),q=t(7158),I=t(7015);function F(e){let{className:s,classNames:t,showOutsideDays:r=!0,...i}=e;return(0,a.jsx)(I._W,{showOutsideDays:r,className:(0,v.cn)("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,v.cn)((0,S.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,v.cn)((0,S.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{...s}=e;return(0,a.jsx)(Z.Z,{className:"h-4 w-4"})},IconRight:e=>{let{...s}=e;return(0,a.jsx)(q.Z,{className:"h-4 w-4"})}},...i})}F.displayName="Calendar";var O=t(1908),B=t(5771),C=t(3160);function T(){let e=(0,i.useParams)(),s=(0,i.useRouter)(),{user:t}=(0,o.tN)(),{addBooking:n}=(0,o.ML)(),[Z,q]=(0,r.useState)(!1),[I,T]=(0,r.useState)(),[R,z]=(0,r.useState)({guests:1,time:"",duration:"",special_requests:"",contact_phone:"",contact_email:(null==t?void 0:t.email)||""}),[A,D]=(0,r.useState)(""),L={id:e.id,title:"Luxury Hotel Suite - Premium Accommodation",category:"hotels",price:75e3,location:"Victoria Island, Lagos",capacity:4,vendor:{business_name:"Grand Lagos Hotels",name:"Adebayo Johnson"}},Y=e=>{z(s=>({...s,[e.target.name]:e.target.value})),A&&D("")},E=()=>I?R.time?R.contact_phone?!(R.guests>L.capacity)||(D("Maximum capacity is ".concat(L.capacity," guests")),!1):(D("Phone number is required"),!1):(D("Please select a time"),!1):(D("Please select a date"),!1),J=()=>{let e=L.price;return e+.05*e},M=async e=>{if(e.preventDefault(),E()){q(!0),D("");try{let e={listing_id:L.id,customer_id:t.id,booking_date:I.toISOString().split("T")[0],booking_time:R.time,guests:parseInt(R.guests),duration:R.duration||null,special_requests:R.special_requests||null,contact_phone:R.contact_phone,contact_email:R.contact_email,total_amount:J(),status:"pending",payment_status:"pending",created_at:new Date().toISOString()},{data:a,error:r}=await (0,d.TB)(e);if(r){D(r.message),b.Am.error("Booking failed",{description:r.message});return}n(a),b.Am.success("Booking request submitted!",{description:"The vendor will review and confirm your booking shortly"}),s.push("/dashboard/customer?tab=bookings")}catch(e){D("An unexpected error occurred"),b.Am.error("Booking failed",{description:"An unexpected error occurred"})}finally{q(!1)}}};return(0,a.jsx)(c.a,{requiredRole:"customer",children:(0,a.jsxs)("div",{className:"container max-w-4xl py-8",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)(l(),{href:"/services/".concat(e.id),className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Back to Service Details"]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)(N.Zb,{children:[(0,a.jsxs)(N.Ol,{children:[(0,a.jsx)(N.ll,{children:"Book This Service"}),(0,a.jsx)(N.SZ,{children:"Fill in the details below to request a booking"})]}),(0,a.jsx)(N.aY,{children:(0,a.jsxs)("form",{onSubmit:M,className:"space-y-6",children:[A&&(0,a.jsxs)(_.bZ,{variant:"destructive",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4"}),(0,a.jsx)(_.X,{children:A})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{children:"Select Date *"}),(0,a.jsxs)(k.J2,{children:[(0,a.jsx)(P.xo,{asChild:!0,children:(0,a.jsxs)(S.z,{variant:"outline",className:(0,v.cn)("w-full justify-start text-left font-normal",!I&&"text-muted-foreground"),children:[(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),I?(0,y.ZP)(I,"PPP"):"Pick a date"]})}),(0,a.jsx)(k.yk,{className:"w-auto p-0",children:(0,a.jsx)(F,{mode:"single",selected:I,onSelect:T,disabled:e=>e<new Date,initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"time",children:"Preferred Time *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(O.I,{id:"time",name:"time",type:"time",value:R.time,onChange:Y,className:"pl-10",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"duration",children:"Duration (Optional)"}),(0,a.jsx)(O.I,{id:"duration",name:"duration",placeholder:"e.g., 2 hours, 1 day",value:R.duration,onChange:Y})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"guests",children:"Number of Guests *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(O.I,{id:"guests",name:"guests",type:"number",min:"1",max:L.capacity,value:R.guests,onChange:Y,className:"pl-10",required:!0})]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Maximum capacity: ",L.capacity," guests"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"contact_phone",children:"Phone Number *"}),(0,a.jsx)(O.I,{id:"contact_phone",name:"contact_phone",type:"tel",value:R.contact_phone,onChange:Y,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"contact_email",children:"Email Address"}),(0,a.jsx)(O.I,{id:"contact_email",name:"contact_email",type:"email",value:R.contact_email,onChange:Y})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{htmlFor:"special_requests",children:"Special Requests (Optional)"}),(0,a.jsx)(B.g,{id:"special_requests",name:"special_requests",value:R.special_requests,onChange:Y,rows:3})]}),(0,a.jsx)(S.z,{type:"submit",className:"w-full",size:"lg",disabled:Z,children:Z?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C.T,{className:"mr-2 h-4 w-4"}),"Processing Booking..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Submit Booking Request"]})})]})})]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(N.Zb,{children:[(0,a.jsx)(N.Ol,{children:(0,a.jsx)(N.ll,{className:"text-lg",children:"Booking Summary"})}),(0,a.jsxs)(N.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:L.title}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["by ",L.vendor.business_name]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-1"}),L.location]}),I&&(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,a.jsx)("span",{children:(0,y.ZP)(I,"PPP")})]}),R.time&&(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,a.jsx)("span",{children:R.time})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,a.jsxs)("span",{children:[R.guests," guest",R.guests>1?"s":""]})]})]})]})]}),(0,a.jsxs)(N.Zb,{children:[(0,a.jsx)(N.Ol,{children:(0,a.jsxs)(N.ll,{className:"text-lg flex items-center",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5 mr-2"}),"Price Details"]})}),(0,a.jsxs)(N.aY,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Service fee"}),(0,a.jsxs)("span",{children:["₦",L.price.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Platform fee (5%)"}),(0,a.jsxs)("span",{children:["₦",(.05*L.price).toLocaleString()]})]}),(0,a.jsx)("div",{className:"border-t pt-3",children:(0,a.jsxs)("div",{className:"flex justify-between font-semibold text-lg",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{children:["₦",J().toLocaleString()]})]})}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Payment will be processed after vendor confirmation"})]})]}),(0,a.jsxs)(N.Zb,{children:[(0,a.jsx)(N.Ol,{children:(0,a.jsx)(N.ll,{className:"text-lg",children:"Booking Policy"})}),(0,a.jsxs)(N.aY,{className:"space-y-2 text-sm text-muted-foreground",children:[(0,a.jsx)("p",{children:"• Booking requests are subject to vendor approval"}),(0,a.jsx)("p",{children:"• Payment is processed only after confirmation"}),(0,a.jsx)("p",{children:"• Free cancellation up to 24 hours before service"}),(0,a.jsx)("p",{children:"• Refund policy applies as per vendor terms"})]})]})]})]})]})})}},1908:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var a=t(7437),r=t(2265),i=t(9311);let n=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},5831:function(e,s,t){"use strict";t.d(s,{J2:function(){return l},xo:function(){return c},yk:function(){return o}});var a=t(7437),r=t(2265),i=t(5050),n=t(9311);let l=i.fC,c=i.xz,o=r.forwardRef((e,s)=>{let{className:t,align:r="center",sideOffset:l=4,...c}=e;return(0,a.jsx)(i.h_,{children:(0,a.jsx)(i.VY,{ref:s,align:r,sideOffset:l,className:(0,n.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...c})})});o.displayName=i.VY.displayName},5771:function(e,s,t){"use strict";t.d(s,{g:function(){return n}});var a=t(7437),r=t(2265),i=t(9311);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...r})});n.displayName="Textarea"}},function(e){e.O(0,[7533,4724,9561,8542,775,700,8554,1181,2971,7864,1744],function(){return e(e.s=9315)}),_N_E=e.O()}]);