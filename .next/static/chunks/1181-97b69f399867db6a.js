"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1181],{2206:function(e,n,t){t.d(n,{X:function(){return d},bZ:function(){return l}});var r=t(7437),a=t(2265),i=t(9213),o=t(9311);let s=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=a.forwardRef((e,n)=>{let{className:t,variant:a,...i}=e;return(0,r.jsx)("div",{ref:n,role:"alert",className:(0,o.cn)(s({variant:a}),t),...i})});l.displayName="Alert";let u=a.forwardRef((e,n)=>{let{className:t,...a}=e;return(0,r.jsx)("h5",{ref:n,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",t),...a})});u.displayName="AlertTitle";let d=a.forwardRef((e,n)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:n,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",t),...a})});d.displayName="AlertDescription"},3023:function(e,n,t){t.d(n,{d:function(){return l},z:function(){return u}});var r=t(7437),a=t(2265),i=t(7256),o=t(9213),s=t(9311);let l=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=a.forwardRef((e,n)=>{let{className:t,variant:a,size:o,asChild:u=!1,...d}=e,c=u?i.g7:"button";return(0,r.jsx)(c,{className:(0,s.cn)(l({variant:a,size:o,className:t})),ref:n,...d})});u.displayName="Button"},6110:function(e,n,t){t.d(n,{Ol:function(){return s},SZ:function(){return u},Zb:function(){return o},aY:function(){return d},ll:function(){return l}});var r=t(7437),a=t(2265),i=t(9311);let o=a.forwardRef((e,n)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:n,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});o.displayName="Card";let s=a.forwardRef((e,n)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:n,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...a})});s.displayName="CardHeader";let l=a.forwardRef((e,n)=>{let{className:t,...a}=e;return(0,r.jsx)("h3",{ref:n,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});l.displayName="CardTitle";let u=a.forwardRef((e,n)=>{let{className:t,...a}=e;return(0,r.jsx)("p",{ref:n,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});u.displayName="CardDescription";let d=a.forwardRef((e,n)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:n,className:(0,i.cn)("p-6 pt-0",t),...a})});d.displayName="CardContent";let c=a.forwardRef((e,n)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:n,className:(0,i.cn)("flex items-center p-6 pt-0",t),...a})});c.displayName="CardFooter"},3160:function(e,n,t){t.d(n,{T:function(){return i}});var r=t(7437),a=t(9311);function i(e){let{className:n,...t}=e;return(0,r.jsx)("div",{className:(0,a.cn)("inline-block animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] text-primary motion-reduce:animate-[spin_1.5s_linear_infinite]",n),role:"status",...t,children:(0,r.jsx)("span",{className:"sr-only",children:"Loading..."})})}},5825:function(e,n,t){t.d(n,{AW:function(){return b},Km:function(){return i},LR:function(){return u},N:function(){return s},TB:function(){return c},X8:function(){return l},Y9:function(){return m},_B:function(){return v},aL:function(){return f},aV:function(){return _},e6:function(){return d},i1:function(){return g},jy:function(){return o},kP:function(){return p},lx:function(){return y},pz:function(){return h},xv:function(){return a}});var r=t(2129);let a=async e=>{try{let{data:n,error:t}=await r.O.from("users").upsert({id:e.id,email:e.email,name:e.name,role:e.role,created_at:e.created_at||new Date().toISOString(),updated_at:new Date().toISOString()}).select().maybeSingle();if(t)throw t;return{data:n,error:null}}catch(e){return console.error("Create user profile error:",e),{data:null,error:e}}},i=async e=>{try{var n,t;let a=await r.O.auth.getSession(),i=null===(t=a.data)||void 0===t?void 0:null===(n=t.session)||void 0===n?void 0:n.access_token;console.log("\uD83D\uDD10 Access token used:",i);let{data:o,error:s}=await r.O.from("vendors").insert({user_id:e.user_id,business_name:e.business_name,business_description:e.business_description,business_address:e.business_address,phone_number:e.phone_number,business_registration_number:e.business_registration_number,tax_identification_number:e.tax_identification_number,bank_account_name:e.bank_account_name,bank_account_number:e.bank_account_number,bank_name:e.bank_name,business_category:e.business_category,years_in_operation:e.years_in_operation,website_url:e.website_url,approved:!1,status:"reviewing",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().maybeSingle();if(s)throw s;try{let n=await fetch("/api/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:"aboderindaniel482@gmail.com",templateName:"kycSubmissionNotice",data:{vendorName:e.business_name,phone:e.phone_number,businessName:e.business_name,dashboardUrl:"".concat("http://www.bookhushly.com","/dashboard/admin/kyc")}})}),t=await n.json();n.ok&&t.success||console.warn("Failed to send KYC submission email:",t.error)}catch(e){console.error("Email dispatch error:",e)}return{data:o,error:null}}catch(e){return console.error("Create vendor profile error:",e),{data:null,error:e}}},o=async e=>{try{let{data:n,error:t}=await r.O.from("vendors").select("\n        *,\n        users (\n          name,\n          email\n        )\n      ").eq("user_id",e).maybeSingle();if(t)throw t;return{data:n,error:null}}catch(e){return console.error("Get vendor profile error:",e),{data:null,error:e}}},s=async(e,n)=>{try{let{data:t,error:a}=await r.O.from("vendors").update(n).eq("id",e).select().single();if(a)throw a;return{data:t,error:null}}catch(e){return{data:null,error:e}}},l=async e=>{try{let{data:n,error:t}=await r.O.from("vendors").select("id").eq("user_id",e.vendor_id).single();if(t)throw t;let{data:a,error:i}=await r.O.from("listings").insert({vendor_id:n.id,title:e.title,description:e.description,category:e.category,price:e.price,location:e.location,capacity:e.capacity,duration:e.duration,availability:e.availability,features:e.features,requirements:e.requirements,cancellation_policy:e.cancellation_policy,media_urls:e.media_urls||[],active:!1!==e.active,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(i)throw i;return{data:a,error:null}}catch(e){return console.error("Create listing error:",e),{data:null,error:e}}},u=async e=>{try{let{data:n,error:t}=await r.O.from("listings").select("\n        *,\n        vendors (\n          business_name,\n          approved,\n          users (\n            name,\n            email\n          )\n        )\n      ").eq("id",e).single();if(t)throw t;return{data:n,error:null}}catch(e){return{data:null,error:e}}},d=async(e,n)=>{try{let{data:t,error:a}=await r.O.from("listings").update(n).eq("id",e).select("\n        *,\n        vendors (\n          business_name,\n          approved,\n          users (\n            name,\n            email\n          )\n        )\n      ").single();if(a)throw a;return{data:t,error:null}}catch(e){return console.error("Update listing error:",e),{data:null,error:e}}},c=async e=>{try{let{data:n,error:t}=await r.O.from("bookings").insert({listing_id:e.listing_id,customer_id:e.customer_id,booking_date:e.booking_date,booking_time:e.booking_time,guests:e.guests,duration:e.duration,special_requests:e.special_requests,contact_phone:e.contact_phone,contact_email:e.contact_email,total_amount:e.total_amount,status:"pending",payment_status:"pending",payment_reference:e.payment_reference||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(t)throw t;return{data:n,error:null}}catch(e){return console.error("Create booking error:",e),{data:null,error:e}}},f=async(e,n)=>{try{if("customer"===n){let{data:n,error:t}=await r.O.from("bookings").select("\n          *,\n          listings (\n            title,\n            category,\n            price,\n            vendors (\n              business_name,\n              users (\n                name,\n                email\n              )\n            )\n          )\n        ").eq("customer_id",e).order("created_at",{ascending:!1});if(t)throw t;return{data:n,error:null}}if("vendor"===n){let{data:n}=await r.O.from("vendors").select("id").eq("user_id",e).single();if(!n)return{data:[],error:null};let{data:t,error:a}=await r.O.from("bookings").select("\n          *,\n          listings (\n            title,\n            category,\n            price,\n            vendors (\n              business_name,\n              users (\n                name,\n                email\n              )\n            )\n          )\n        ").eq("listings.vendor_id",n.id).order("created_at",{ascending:!1});if(a)throw a;return{data:t,error:null}}return{data:[],error:null}}catch(e){return console.error("Get bookings error:",e),{data:null,error:e}}},g=async(e,n)=>{try{let{data:t,error:a}=await r.O.from("bookings").update({status:n}).eq("id",e).select().single();if(a)throw a;return{data:t,error:null}}catch(e){return{data:null,error:e}}},m=async()=>{try{let{data:e,error:n}=await r.O.rpc("get_admin_stats");if(n)throw n;return{data:e,error:null}}catch(e){return console.error("Get admin stats error:",e),{data:{totalUsers:0,totalVendors:0,totalBookings:0,totalRevenue:0,pendingApprovals:0,activeListings:0,monthlyGrowth:0,conversionRate:0},error:null}}},p=async()=>{try{let{data:e,error:n}=await r.O.from("vendors").select("\n        *,\n        users (\n          name,\n          email\n        )\n      ").eq("approved",!1).order("created_at",{ascending:!1});if(n)throw n;return{data:e,error:null}}catch(e){return console.error("Get pending vendors error:",e),{data:null,error:e}}},_=async(e,n)=>{try{let{data:t,error:a}=await r.O.from("vendors").update({approved:n,status:"approved",approved_at:n?new Date().toISOString():null,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw a;return{data:t,error:null}}catch(e){return console.error("Approve vendor error:",e),{data:null,error:e}}},b=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let n=r.O.from("users").select("*").order("created_at",{ascending:!1});e.limit&&(n=n.limit(e.limit));let{data:t,error:a}=await n;if(a)throw a;return{data:t,error:null}}catch(e){return{data:null,error:e}}},v=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let n=r.O.from("bookings").select("\n        *,\n        listings (\n          title,\n          category,\n          vendors (\n            business_name\n          )\n        )\n      ").order("created_at",{ascending:!1});e.limit&&(n=n.limit(e.limit));let{data:t,error:a}=await n;if(a)throw a;return{data:t,error:null}}catch(e){return{data:null,error:e}}},y=async e=>{try{let{data:n,error:t}=await r.O.from("bookings").select("\n        *,\n        listings (\n          title,\n          category,\n          price,\n          vendors (\n            business_name,\n            users (\n              name,\n              email\n            )\n          )\n        )\n      ").eq("id",e).single();if(console.error("Booking data:",n),t)throw t;return{data:n,error:null}}catch(e){return{data:null,error:e}}},h=async function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let a={payment_status:n,updated_at:new Date().toISOString()};t&&(a.payment_reference=t),"completed"===n&&(a.status="confirmed");let{data:i,error:o}=await r.O.from("bookings").update(a).eq("id",e).select().single();if(o)throw o;return{data:i,error:null}}catch(e){return{data:null,error:e}}}},4045:function(e,n,t){t.d(n,{Ae:function(){return s},ML:function(){return o},tN:function(){return i}});var r=t(9115),a=t(4810);let i=(0,r.U)((0,a.tJ)((e,n)=>({user:null,loading:!0,setUser:n=>e({user:n}),setLoading:n=>e({loading:n}),logout:()=>e({user:null})}),{name:"auth-storage"})),o=(0,r.U)((e,n)=>({bookings:[],loading:!1,setBookings:n=>e({bookings:n}),setLoading:n=>e({loading:n}),addBooking:n=>e(e=>({bookings:[...e.bookings,n]})),updateBooking:(n,t)=>e(e=>({bookings:e.bookings.map(e=>e.id===n?{...e,...t}:e)}))})),s=(0,r.U)((e,n)=>({listings:[],loading:!1,setListings:n=>e({listings:n}),setLoading:n=>e({loading:n}),addListing:n=>e(e=>({listings:[...e.listings,n]})),updateListing:(n,t)=>e(e=>({listings:e.listings.map(e=>e.id===n?{...e,...t}:e)})),deleteListing:n=>e(e=>({listings:e.listings.filter(e=>e.id!==n)}))}))},2129:function(e,n,t){t.d(n,{O:function(){return a}});var r=t(3082);let a=(0,r.createClientComponentClient)()},9311:function(e,n,t){t.d(n,{cn:function(){return i}});var r=t(7042),a=t(4769);function i(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,a.m6)((0,r.W)(n))}}}]);