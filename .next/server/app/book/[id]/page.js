(()=>{var e={};e.id=6193,e.ids=[6193],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},37335:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>u,routeModule:()=>p,tree:()=>d});var r=t(73137),a=t(54647),i=t(4183),n=t.n(i),o=t(71775),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);t.d(s,c);let l=r.AppPageRouteModule,d=["",{children:["book",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,68264)),"C:\\Users\\D\\Downloads\\Bookhushly.com-main\\Bookhushly.com-main\\app\\book\\[id]\\page.jsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,48818)),"C:\\Users\\D\\Downloads\\Bookhushly.com-main\\Bookhushly.com-main\\app\\layout.jsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,51918,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\D\\Downloads\\Bookhushly.com-main\\Bookhushly.com-main\\app\\book\\[id]\\page.jsx"],m="/book/[id]/page",x={require:t,loadChunk:()=>Promise.resolve()},p=new l({definition:{kind:a.x.APP_PAGE,page:"/book/[id]/page",pathname:"/book/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},12987:(e,s,t)=>{Promise.resolve().then(t.bind(t,10047))},10047:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>F});var r=t(60080),a=t(9885),i=t(57114),n=t(11440),o=t.n(n),c=t(99767),l=t(80850),d=t(95440);t(46757);var u=t(5705),m=t(79803),x=t(43917),p=t(517),h=t(15441),g=t(91672),f=t(96253),j=t(87094),y=t(78260),v=t(49268),b=t(23161),N=t(9941),_=t(97052),w=t(81704),q=t(33478),k=t(88042),P=t(68384),S=t(51910),Z=t(11922),B=t(28070);function C({className:e,classNames:s,showOutsideDays:t=!0,...a}){return r.jsx(B._W,{showOutsideDays:t,className:(0,b.cn)("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,b.cn)((0,P.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,b.cn)((0,P.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({...e})=>r.jsx(S.Z,{className:"h-4 w-4"}),IconRight:({...e})=>r.jsx(Z.Z,{className:"h-4 w-4"})},...a})}C.displayName="Calendar";var D=t(49424),A=t(76466),E=t(84827);function F(){let e=(0,i.useParams)(),s=(0,i.useRouter)(),{user:t}=(0,l.tN)(),{addBooking:n}=(0,l.ML)(),[S,Z]=(0,a.useState)(!1),[B,F]=(0,a.useState)(!0),[I,R]=(0,a.useState)(null),[O,T]=(0,a.useState)(""),[L,M]=(0,a.useState)(),[U,z]=(0,a.useState)({guests:1,time:"",duration:"",special_requests:"",contact_phone:"",contact_email:t?.email||""}),[G,Y]=(0,a.useState)("");(0,a.useEffect)(()=>{let s=async()=>{if(e.id)try{F(!0);let{data:s,error:t}=await (0,d.LR)(e.id);if(t){console.error("Error fetching listing:",t),T("Failed to load service details");return}R(s)}catch(e){console.error("Exception fetching service:",e),T("An error occurred while loading service details")}finally{F(!1)}};s()},[e.id]),(0,a.useEffect)(()=>{t?.email&&z(e=>({...e,contact_email:t.email}))},[t]);let X=e=>{z(s=>({...s,[e.target.name]:e.target.value})),G&&Y("")},$=()=>L?U.time?U.contact_phone?U.contact_email?!I?.capacity||!(U.guests>I.capacity)||(Y(`Maximum capacity is ${I.capacity} guests`),!1):(Y("Email address is required"),!1):(Y("Phone number is required"),!1):(Y("Please select a time"),!1):(Y("Please select a date"),!1),J=()=>{if(!I)return 0;let e=I.price;return e+.05*e},W=(0,a.useRef)(`book-${crypto.randomUUID()}`);console.log("Booking reference:",W.current);let H=async e=>{if(e.preventDefault(),$()&&I&&t){Z(!0),Y("");try{let e={listing_id:I.id,customer_id:t.id,booking_date:L.toISOString().split("T")[0],booking_time:U.time,guests:parseInt(U.guests),duration:U.duration||null,special_requests:U.special_requests||null,contact_phone:U.contact_phone,contact_email:U.contact_email,total_amount:J(),status:"pending",payment_status:"pending",payment_reference:""};console.log("Booking payload â†’",e);let{data:r,error:a}=await (0,d.TB)(e);if(a){Y(a.message),N.Am.error("Booking failed",{description:a.message});return}n(r),N.Am.success("Booking request submitted!",{description:"The vendor will review and confirm your booking shortly"}),s.push("/dashboard/customer?tab=bookings")}catch(e){console.error("Booking error:",e),Y("An unexpected error occurred"),N.Am.error("Booking failed",{description:"An unexpected error occurred"})}finally{Z(!1)}}};return B?r.jsx(c.a,{requiredRole:"customer",children:r.jsx("div",{className:"container max-w-4xl py-8",children:r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(u.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),r.jsx("p",{className:"text-muted-foreground",children:"Loading service details..."})]})})})}):O||!I?r.jsx(c.a,{requiredRole:"customer",children:(0,r.jsxs)("div",{className:"container max-w-4xl py-8",children:[r.jsx("div",{className:"mb-6",children:(0,r.jsxs)(o(),{href:"/services",className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[r.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"Back to Services"]})}),(0,r.jsxs)(w.bZ,{variant:"destructive",children:[r.jsx(x.Z,{className:"h-4 w-4"}),r.jsx(w.X,{children:O||"Service not found"})]})]})}):r.jsx(c.a,{requiredRole:"customer",children:(0,r.jsxs)("div",{className:"container max-w-4xl py-8",children:[r.jsx("div",{className:"mb-6",children:(0,r.jsxs)(o(),{href:`/services/${e.id}`,className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground",children:[r.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"Back to Service Details"]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsx("div",{className:"lg:col-span-2",children:(0,r.jsxs)(_.Zb,{children:[(0,r.jsxs)(_.Ol,{children:[r.jsx(_.ll,{children:"Book This Service"}),r.jsx(_.SZ,{children:"Fill in the details below to request a booking"})]}),r.jsx(_.aY,{children:(0,r.jsxs)("form",{onSubmit:H,className:"space-y-6",children:[G&&(0,r.jsxs)(w.bZ,{variant:"destructive",children:[r.jsx(x.Z,{className:"h-4 w-4"}),r.jsx(w.X,{children:G})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(q._,{children:"Select Date *"}),(0,r.jsxs)(k.J2,{children:[r.jsx(k.xo,{asChild:!0,children:(0,r.jsxs)(P.z,{variant:"outline",className:(0,b.cn)("w-full justify-start text-left font-normal",!L&&"text-muted-foreground"),children:[r.jsx(p.Z,{className:"mr-2 h-4 w-4"}),L?(0,v.ZP)(L,"PPP"):"Pick a date"]})}),r.jsx(k.yk,{className:"w-auto p-0",children:r.jsx(C,{mode:"single",selected:L,onSelect:M,disabled:e=>e<new Date,initialFocus:!0})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(q._,{htmlFor:"time",children:"Preferred Time *"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx(h.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(D.I,{id:"time",name:"time",type:"time",value:U.time,onChange:X,className:"pl-10",required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(q._,{htmlFor:"duration",children:"Duration"}),r.jsx(D.I,{id:"duration",name:"duration",placeholder:I.duration||"e.g., 2 hours, 1 day",value:U.duration,onChange:X}),I.duration&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Standard duration: ",I.duration]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(q._,{htmlFor:"guests",children:"Number of Guests *"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx(g.Z,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(D.I,{id:"guests",name:"guests",type:"number",min:"1",max:I.capacity||100,value:U.guests,onChange:X,className:"pl-10",required:!0})]}),I.capacity&&(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Maximum capacity: ",I.capacity," guests"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(q._,{htmlFor:"contact_phone",children:"Phone Number *"}),r.jsx(D.I,{id:"contact_phone",name:"contact_phone",type:"tel",value:U.contact_phone,onChange:X,required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(q._,{htmlFor:"contact_email",children:"Email Address *"}),r.jsx(D.I,{id:"contact_email",name:"contact_email",type:"email",value:U.contact_email,onChange:X,required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(q._,{htmlFor:"special_requests",children:"Special Requests (Optional)"}),r.jsx(A.g,{id:"special_requests",name:"special_requests",value:U.special_requests,onChange:X,rows:3,placeholder:"Any special requirements or requests..."})]}),r.jsx(P.z,{type:"submit",className:"w-full",size:"lg",disabled:S,children:S?(0,r.jsxs)(r.Fragment,{children:[r.jsx(E.T,{className:"mr-2 h-4 w-4"}),"Processing Booking..."]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(f.Z,{className:"mr-2 h-4 w-4"}),"Submit Booking Request"]})})]})})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(_.Zb,{children:[r.jsx(_.Ol,{children:r.jsx(_.ll,{className:"text-lg",children:"Booking Summary"})}),(0,r.jsxs)(_.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium",children:I.title}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["by ",I.vendors?.business_name||"Service Provider"]})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[r.jsx(j.Z,{className:"h-4 w-4 mr-1"}),I.location]}),L&&(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(p.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),r.jsx("span",{children:(0,v.ZP)(L,"PPP")})]}),U.time&&(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(h.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),r.jsx("span",{children:U.time})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(g.Z,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,r.jsxs)("span",{children:[U.guests," guest",U.guests>1?"s":""]})]})]})]})]}),(0,r.jsxs)(_.Zb,{children:[r.jsx(_.Ol,{children:(0,r.jsxs)(_.ll,{className:"text-lg flex items-center",children:[r.jsx(y.Z,{className:"h-5 w-5 mr-2"}),"Price Details"]})}),(0,r.jsxs)(_.aY,{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Service fee"}),(0,r.jsxs)("span",{children:["â‚¦",I.price?.toLocaleString()||"0"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Platform fee (5%)"}),(0,r.jsxs)("span",{children:["â‚¦",(.05*(I.price||0)).toLocaleString()]})]}),r.jsx("div",{className:"border-t pt-3",children:(0,r.jsxs)("div",{className:"flex justify-between font-semibold text-lg",children:[r.jsx("span",{children:"Total"}),(0,r.jsxs)("span",{children:["â‚¦",J().toLocaleString()]})]})}),r.jsx("div",{className:"text-xs text-muted-foreground",children:"Payment will be processed after vendor confirmation"})]})]}),(0,r.jsxs)(_.Zb,{children:[r.jsx(_.Ol,{children:r.jsx(_.ll,{className:"text-lg",children:"Booking Policy"})}),(0,r.jsxs)(_.aY,{className:"space-y-2 text-sm text-muted-foreground",children:[r.jsx("p",{children:"â€¢ Booking requests are subject to vendor approval"}),r.jsx("p",{children:"â€¢ Payment is processed only after confirmation"}),I.cancellation_policy?(0,r.jsxs)("p",{children:["â€¢ ",I.cancellation_policy]}):r.jsx("p",{children:"â€¢ Free cancellation up to 24 hours before service"}),r.jsx("p",{children:"â€¢ Refund policy applies as per vendor terms"})]})]})]})]})]})})}},49424:(e,s,t)=>{"use strict";t.d(s,{I:()=>n});var r=t(60080),a=t(9885),i=t(23161);let n=a.forwardRef(({className:e,type:s,...t},a)=>r.jsx("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...t}));n.displayName="Input"},68264:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u,generateStaticParams:()=>d});var r=t(48144),a=t(43060),i=t(17536);let n=(0,i.createProxy)(String.raw`C:\Users\D\Downloads\Bookhushly.com-main\Bookhushly.com-main\components\book\BookServiceClient.jsx`),{__esModule:o,$$typeof:c}=n,l=n.default;async function d(){try{let{data:e,error:s}=await a.O.from("listings").select("id").eq("active",!0);if(s)return console.error("Error fetching services for book static generation:",s),[];return e.map(e=>({id:e.id.toString()}))}catch(e){return console.error("Exception in generateStaticParams for book service:",e),[]}}function u(){return r.jsx(l,{})}},43060:(e,s,t)=>{"use strict";t.d(s,{O:()=>a});var r=t(17207);let a=(0,r.createClientComponentClient)()}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[4650,977,1823,3433,5002,8204,5964,1704,3692,9767,812],()=>t(37335));module.exports=r})();