"use strict";exports.id=5002,exports.ids=[5002],exports.modules={87094:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(75593);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,a.Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},17207:(e,t,r)=>{var a,i=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,d={};((e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})})(d,{createBrowserSupabaseClient:()=>A,createClientComponentClient:()=>l,createMiddlewareClient:()=>v,createMiddlewareSupabaseClient:()=>k,createPagesBrowserClient:()=>u,createPagesServerClient:()=>y,createRouteHandlerClient:()=>I,createServerActionClient:()=>P,createServerComponentClient:()=>b,createServerSupabaseClient:()=>C}),e.exports=((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of o(t))s.call(e,r)||void 0===r||i(e,r,{get:()=>t[r],enumerable:!(a=n(t,r))||a.enumerable});return e})(i({},"__esModule",{value:!0}),d);var c=r(26841);function l({supabaseUrl:e="https://lyhrksnxjoqkuwpebffx.supabase.co",supabaseKey:t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5aHJrc254am9xa3V3cGViZmZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NzY4ODgsImV4cCI6MjA2ODA1Mjg4OH0.Xt4ZO0C5msAxLIyw8_01ApwG2gtEVBgdoeIdqKqud3Q",options:r,cookieOptions:i,isSingleton:n=!0}={}){if(!e||!t)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");let o=()=>{var a;return(0,c.createSupabaseClient)(e,t,{...r,global:{...null==r?void 0:r.global,headers:{...null==(a=null==r?void 0:r.global)?void 0:a.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.10.0"}},auth:{storage:new c.BrowserCookieAuthStorageAdapter(i)}})};if(n){let e=a??o();return e}return o()}var u=l,p=r(26841),f=r(74418),h=class extends p.CookieAuthStorageAdapter{constructor(e,t){super(t),this.context=e}getCookie(e){var t,r,a;let i=(0,f.splitCookiesString)((null==(r=null==(t=this.context.res)?void 0:t.getHeader("set-cookie"))?void 0:r.toString())??"").map(t=>(0,p.parseCookies)(t)[e]).find(e=>!!e),n=i??(null==(a=this.context.req)?void 0:a.cookies[e]);return n}setCookie(e,t){this._setCookie(e,t)}deleteCookie(e){this._setCookie(e,"",{maxAge:0})}_setCookie(e,t,r){var a;let i=(0,f.splitCookiesString)((null==(a=this.context.res.getHeader("set-cookie"))?void 0:a.toString())??"").filter(t=>!(e in(0,p.parseCookies)(t))),n=(0,p.serializeCookie)(e,t,{...this.cookieOptions,...r,httpOnly:!1});this.context.res.setHeader("set-cookie",[...i,n])}};function y(e,{supabaseUrl:t="https://lyhrksnxjoqkuwpebffx.supabase.co",supabaseKey:r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5aHJrc254am9xa3V3cGViZmZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NzY4ODgsImV4cCI6MjA2ODA1Mjg4OH0.Xt4ZO0C5msAxLIyw8_01ApwG2gtEVBgdoeIdqKqud3Q",options:a,cookieOptions:i}={}){var n;if(!t||!r)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,p.createSupabaseClient)(t,r,{...a,global:{...null==a?void 0:a.global,headers:{...null==(n=null==a?void 0:a.global)?void 0:n.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.10.0"}},auth:{storage:new h(e,i)}})}var m=r(26841),w=r(74418),g=class extends m.CookieAuthStorageAdapter{constructor(e,t){super(t),this.context=e}getCookie(e){var t;let r=(0,w.splitCookiesString)((null==(t=this.context.res.headers.get("set-cookie"))?void 0:t.toString())??"").map(t=>(0,m.parseCookies)(t)[e]).find(e=>!!e);if(r)return r;let a=(0,m.parseCookies)(this.context.req.headers.get("cookie")??"");return a[e]}setCookie(e,t){this._setCookie(e,t)}deleteCookie(e){this._setCookie(e,"",{maxAge:0})}_setCookie(e,t,r){let a=(0,m.serializeCookie)(e,t,{...this.cookieOptions,...r,httpOnly:!1});this.context.res.headers&&this.context.res.headers.append("set-cookie",a)}};function v(e,{supabaseUrl:t="https://lyhrksnxjoqkuwpebffx.supabase.co",supabaseKey:r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5aHJrc254am9xa3V3cGViZmZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NzY4ODgsImV4cCI6MjA2ODA1Mjg4OH0.Xt4ZO0C5msAxLIyw8_01ApwG2gtEVBgdoeIdqKqud3Q",options:a,cookieOptions:i}={}){var n;if(!t||!r)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,m.createSupabaseClient)(t,r,{...a,global:{...null==a?void 0:a.global,headers:{...null==(n=null==a?void 0:a.global)?void 0:n.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.10.0"}},auth:{storage:new g(e,i)}})}var S=r(26841),E=class extends S.CookieAuthStorageAdapter{constructor(e,t){super(t),this.context=e,this.isServer=!0}getCookie(e){var t;let r=this.context.cookies();return null==(t=r.get(e))?void 0:t.value}setCookie(e,t){}deleteCookie(e){}};function b(e,{supabaseUrl:t="https://lyhrksnxjoqkuwpebffx.supabase.co",supabaseKey:r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5aHJrc254am9xa3V3cGViZmZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NzY4ODgsImV4cCI6MjA2ODA1Mjg4OH0.Xt4ZO0C5msAxLIyw8_01ApwG2gtEVBgdoeIdqKqud3Q",options:a,cookieOptions:i}={}){var n;if(!t||!r)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,S.createSupabaseClient)(t,r,{...a,global:{...null==a?void 0:a.global,headers:{...null==(n=null==a?void 0:a.global)?void 0:n.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.10.0"}},auth:{storage:new E(e,i)}})}var _=r(26841),J=class extends _.CookieAuthStorageAdapter{constructor(e,t){super(t),this.context=e}getCookie(e){var t;let r=this.context.cookies();return null==(t=r.get(e))?void 0:t.value}setCookie(e,t){let r=this.context.cookies();r.set(e,t,this.cookieOptions)}deleteCookie(e){let t=this.context.cookies();t.set(e,"",{...this.cookieOptions,maxAge:0})}};function I(e,{supabaseUrl:t="https://lyhrksnxjoqkuwpebffx.supabase.co",supabaseKey:r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5aHJrc254am9xa3V3cGViZmZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NzY4ODgsImV4cCI6MjA2ODA1Mjg4OH0.Xt4ZO0C5msAxLIyw8_01ApwG2gtEVBgdoeIdqKqud3Q",options:a,cookieOptions:i}={}){var n;if(!t||!r)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,_.createSupabaseClient)(t,r,{...a,global:{...null==a?void 0:a.global,headers:{...null==(n=null==a?void 0:a.global)?void 0:n.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.10.0"}},auth:{storage:new J(e,i)}})}var P=I;function A({supabaseUrl:e="https://lyhrksnxjoqkuwpebffx.supabase.co",supabaseKey:t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5aHJrc254am9xa3V3cGViZmZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NzY4ODgsImV4cCI6MjA2ODA1Mjg4OH0.Xt4ZO0C5msAxLIyw8_01ApwG2gtEVBgdoeIdqKqud3Q",options:r,cookieOptions:a}={}){return console.warn("Please utilize the `createPagesBrowserClient` function instead of the deprecated `createBrowserSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs-pages"),u({supabaseUrl:e,supabaseKey:t,options:r,cookieOptions:a})}function C(e,{supabaseUrl:t="https://lyhrksnxjoqkuwpebffx.supabase.co",supabaseKey:r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5aHJrc254am9xa3V3cGViZmZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NzY4ODgsImV4cCI6MjA2ODA1Mjg4OH0.Xt4ZO0C5msAxLIyw8_01ApwG2gtEVBgdoeIdqKqud3Q",options:a,cookieOptions:i}={}){return console.warn("Please utilize the `createPagesServerClient` function instead of the deprecated `createServerSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs-pages"),y(e,{supabaseUrl:t,supabaseKey:r,options:a,cookieOptions:i})}function k(e,{supabaseUrl:t="https://lyhrksnxjoqkuwpebffx.supabase.co",supabaseKey:r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5aHJrc254am9xa3V3cGViZmZ4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0NzY4ODgsImV4cCI6MjA2ODA1Mjg4OH0.Xt4ZO0C5msAxLIyw8_01ApwG2gtEVBgdoeIdqKqud3Q",options:a,cookieOptions:i}={}){return console.warn("Please utilize the `createMiddlewareClient` function instead of the deprecated `createMiddlewareSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs#middleware"),v(e,{supabaseUrl:t,supabaseKey:r,options:a,cookieOptions:i})}},26841:(e,t,r)=>{var a,i,n=Object.create,o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,c=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,u=(e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of d(t))l.call(e,i)||i===r||o(e,i,{get:()=>t[i],enumerable:!(a=s(t,i))||a.enumerable});return e},p=(e,t,r)=>(r=null!=e?n(c(e)):{},u(!t&&e&&e.__esModule?r:o(r,"default",{value:e,enumerable:!0}),e)),f=(a={"../../node_modules/.pnpm/cookie@0.5.0/node_modules/cookie/index.js"(e){e.parse=function(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var r={},i=(t||{}).decode||a,n=0;n<e.length;){var o=e.indexOf("=",n);if(-1===o)break;var s=e.indexOf(";",n);if(-1===s)s=e.length;else if(s<o){n=e.lastIndexOf(";",o-1)+1;continue}var d=e.slice(n,o).trim();if(void 0===r[d]){var c=e.slice(o+1,s).trim();34===c.charCodeAt(0)&&(c=c.slice(1,-1)),r[d]=function(e,t){try{return t(e)}catch(t){return e}}(c,i)}n=s+1}return r},e.serialize=function(e,a,n){var o=n||{},s=o.encode||i;if("function"!=typeof s)throw TypeError("option encode is invalid");if(!r.test(e))throw TypeError("argument name is invalid");var d=s(a);if(d&&!r.test(d))throw TypeError("argument val is invalid");var c=e+"="+d;if(null!=o.maxAge){var l=o.maxAge-0;if(isNaN(l)||!isFinite(l))throw TypeError("option maxAge is invalid");c+="; Max-Age="+Math.floor(l)}if(o.domain){if(!r.test(o.domain))throw TypeError("option domain is invalid");c+="; Domain="+o.domain}if(o.path){if(!r.test(o.path))throw TypeError("option path is invalid");c+="; Path="+o.path}if(o.expires){var u=o.expires;if("[object Date]"!==t.call(u)&&!(u instanceof Date)||isNaN(u.valueOf()))throw TypeError("option expires is invalid");c+="; Expires="+u.toUTCString()}if(o.httpOnly&&(c+="; HttpOnly"),o.secure&&(c+="; Secure"),o.priority)switch("string"==typeof o.priority?o.priority.toLowerCase():o.priority){case"low":c+="; Priority=Low";break;case"medium":c+="; Priority=Medium";break;case"high":c+="; Priority=High";break;default:throw TypeError("option priority is invalid")}if(o.sameSite)switch("string"==typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite){case!0:case"strict":c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"none":c+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return c};var t=Object.prototype.toString,r=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function a(e){return -1!==e.indexOf("%")?decodeURIComponent(e):e}function i(e){return encodeURIComponent(e)}}},function(){return i||(0,a[d(a)[0]])((i={exports:{}}).exports,i),i.exports}),h={};((e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})})(h,{BrowserCookieAuthStorageAdapter:()=>J,CookieAuthStorageAdapter:()=>_,DEFAULT_COOKIE_OPTIONS:()=>S,createSupabaseClient:()=>P,isBrowser:()=>v,parseCookies:()=>y.parse,parseSupabaseCookie:()=>w,serializeCookie:()=>y.serialize,stringifySupabaseSession:()=>g}),e.exports=u(o({},"__esModule",{value:!0}),h),p(f());var y=p(f()),m=r(29003);function w(e){if(!e)return null;try{let t=JSON.parse(e);if(!t)return null;if("Object"===t.constructor.name)return t;if("Array"!==t.constructor.name)throw Error(`Unexpected format: ${t.constructor.name}`);let[r,a,i]=t[0].split("."),n=m.base64url.decode(a),o=new TextDecoder,{exp:s,sub:d,...c}=JSON.parse(o.decode(n));return{expires_at:s,expires_in:s-Math.round(Date.now()/1e3),token_type:"bearer",access_token:t[0],refresh_token:t[1],provider_token:t[2],provider_refresh_token:t[3],user:{id:d,factors:t[4],...c}}}catch(e){return console.warn("Failed to parse cookie string:",e),null}}function g(e){var t;return JSON.stringify([e.access_token,e.refresh_token,e.provider_token,e.provider_refresh_token,(null==(t=e.user)?void 0:t.factors)??null])}function v(){return!1}var S={path:"/",sameSite:"lax",maxAge:31536e6};function E(e){return RegExp(".{1,"+e+"}","g")}var b=E(3180),_=class{constructor(e){this.cookieOptions={...S,...e,maxAge:S.maxAge}}getItem(e){let t=this.getCookie(e);if(e.endsWith("-code-verifier")&&t)return t;if(t)return JSON.stringify(w(t));let r=function(e,t=()=>null){let r=[];for(let a=0;;a++){let i=`${e}.${a}`,n=t(i);if(!n)break;r.push(n)}return r.length?r.join(""):null}(e,e=>this.getCookie(e));return null!==r?JSON.stringify(w(r)):null}setItem(e,t){if(e.endsWith("-code-verifier")){this.setCookie(e,t);return}let r=JSON.parse(t),a=g(r),i=function(e,t,r){let a=void 0!==r?E(r):b,i=Math.ceil(t.length/(r??3180));if(1===i)return[{name:e,value:t}];let n=[],o=t.match(a);return null==o||o.forEach((t,r)=>{let a=`${e}.${r}`;n.push({name:a,value:t})}),n}(e,a);i.forEach(e=>{this.setCookie(e.name,e.value)})}removeItem(e){this._deleteSingleCookie(e),this._deleteChunkedCookies(e)}_deleteSingleCookie(e){this.getCookie(e)&&this.deleteCookie(e)}_deleteChunkedCookies(e,t=0){for(let r=t;;r++){let t=`${e}.${r}`,a=this.getCookie(t);if(void 0===a)break;this.deleteCookie(t)}}},J=class extends _{constructor(e){super(e)}getCookie(e){return null}setCookie(e,t){return null}deleteCookie(e){return null}},I=r(63433);function P(e,t,r){var a;return(0,I.createClient)(e,t,{...r,auth:{flowType:"pkce",autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!0,storage:r.auth.storage,...(null==(a=r.auth)?void 0:a.storageKey)?{storageKey:r.auth.storageKey}:{}}})}},29003:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cryptoRuntime=t.base64url=t.generateSecret=t.generateKeyPair=t.errors=t.decodeJwt=t.decodeProtectedHeader=t.importJWK=t.importX509=t.importPKCS8=t.importSPKI=t.exportJWK=t.exportSPKI=t.exportPKCS8=t.UnsecuredJWT=t.createRemoteJWKSet=t.createLocalJWKSet=t.EmbeddedJWK=t.calculateJwkThumbprintUri=t.calculateJwkThumbprint=t.EncryptJWT=t.SignJWT=t.GeneralSign=t.FlattenedSign=t.CompactSign=t.FlattenedEncrypt=t.CompactEncrypt=t.jwtDecrypt=t.jwtVerify=t.generalVerify=t.flattenedVerify=t.compactVerify=t.GeneralEncrypt=t.generalDecrypt=t.flattenedDecrypt=t.compactDecrypt=void 0;var a=r(14846);Object.defineProperty(t,"compactDecrypt",{enumerable:!0,get:function(){return a.compactDecrypt}});var i=r(48634);Object.defineProperty(t,"flattenedDecrypt",{enumerable:!0,get:function(){return i.flattenedDecrypt}});var n=r(39716);Object.defineProperty(t,"generalDecrypt",{enumerable:!0,get:function(){return n.generalDecrypt}});var o=r(91337);Object.defineProperty(t,"GeneralEncrypt",{enumerable:!0,get:function(){return o.GeneralEncrypt}});var s=r(82863);Object.defineProperty(t,"compactVerify",{enumerable:!0,get:function(){return s.compactVerify}});var d=r(82558);Object.defineProperty(t,"flattenedVerify",{enumerable:!0,get:function(){return d.flattenedVerify}});var c=r(89778);Object.defineProperty(t,"generalVerify",{enumerable:!0,get:function(){return c.generalVerify}});var l=r(73354);Object.defineProperty(t,"jwtVerify",{enumerable:!0,get:function(){return l.jwtVerify}});var u=r(73220);Object.defineProperty(t,"jwtDecrypt",{enumerable:!0,get:function(){return u.jwtDecrypt}});var p=r(82814);Object.defineProperty(t,"CompactEncrypt",{enumerable:!0,get:function(){return p.CompactEncrypt}});var f=r(14459);Object.defineProperty(t,"FlattenedEncrypt",{enumerable:!0,get:function(){return f.FlattenedEncrypt}});var h=r(14504);Object.defineProperty(t,"CompactSign",{enumerable:!0,get:function(){return h.CompactSign}});var y=r(88515);Object.defineProperty(t,"FlattenedSign",{enumerable:!0,get:function(){return y.FlattenedSign}});var m=r(72293);Object.defineProperty(t,"GeneralSign",{enumerable:!0,get:function(){return m.GeneralSign}});var w=r(52886);Object.defineProperty(t,"SignJWT",{enumerable:!0,get:function(){return w.SignJWT}});var g=r(78259);Object.defineProperty(t,"EncryptJWT",{enumerable:!0,get:function(){return g.EncryptJWT}});var v=r(96994);Object.defineProperty(t,"calculateJwkThumbprint",{enumerable:!0,get:function(){return v.calculateJwkThumbprint}}),Object.defineProperty(t,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return v.calculateJwkThumbprintUri}});var S=r(10438);Object.defineProperty(t,"EmbeddedJWK",{enumerable:!0,get:function(){return S.EmbeddedJWK}});var E=r(7574);Object.defineProperty(t,"createLocalJWKSet",{enumerable:!0,get:function(){return E.createLocalJWKSet}});var b=r(66245);Object.defineProperty(t,"createRemoteJWKSet",{enumerable:!0,get:function(){return b.createRemoteJWKSet}});var _=r(48208);Object.defineProperty(t,"UnsecuredJWT",{enumerable:!0,get:function(){return _.UnsecuredJWT}});var J=r(73640);Object.defineProperty(t,"exportPKCS8",{enumerable:!0,get:function(){return J.exportPKCS8}}),Object.defineProperty(t,"exportSPKI",{enumerable:!0,get:function(){return J.exportSPKI}}),Object.defineProperty(t,"exportJWK",{enumerable:!0,get:function(){return J.exportJWK}});var I=r(9501);Object.defineProperty(t,"importSPKI",{enumerable:!0,get:function(){return I.importSPKI}}),Object.defineProperty(t,"importPKCS8",{enumerable:!0,get:function(){return I.importPKCS8}}),Object.defineProperty(t,"importX509",{enumerable:!0,get:function(){return I.importX509}}),Object.defineProperty(t,"importJWK",{enumerable:!0,get:function(){return I.importJWK}});var P=r(2785);Object.defineProperty(t,"decodeProtectedHeader",{enumerable:!0,get:function(){return P.decodeProtectedHeader}});var A=r(92114);Object.defineProperty(t,"decodeJwt",{enumerable:!0,get:function(){return A.decodeJwt}}),t.errors=r(96904);var C=r(63158);Object.defineProperty(t,"generateKeyPair",{enumerable:!0,get:function(){return C.generateKeyPair}});var k=r(96505);Object.defineProperty(t,"generateSecret",{enumerable:!0,get:function(){return k.generateSecret}}),t.base64url=r(59829);var O=r(34174);Object.defineProperty(t,"cryptoRuntime",{enumerable:!0,get:function(){return O.default}})},14846:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.compactDecrypt=void 0;let a=r(48634),i=r(96904),n=r(27610);async function o(e,t,r){if(e instanceof Uint8Array&&(e=n.decoder.decode(e)),"string"!=typeof e)throw new i.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:o,1:s,2:d,3:c,4:l,length:u}=e.split(".");if(5!==u)throw new i.JWEInvalid("Invalid Compact JWE");let p=await (0,a.flattenedDecrypt)({ciphertext:c,iv:d||void 0,protected:o||void 0,tag:l||void 0,encrypted_key:s||void 0},t,r),f={plaintext:p.plaintext,protectedHeader:p.protectedHeader};return"function"==typeof t?{...f,key:p.key}:f}t.compactDecrypt=o},82814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CompactEncrypt=void 0;let a=r(14459);t.CompactEncrypt=class{constructor(e){this._flattened=new a.FlattenedEncrypt(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}},48634:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.flattenedDecrypt=void 0;let a=r(40049),i=r(49810),n=r(19868),o=r(96904),s=r(54006),d=r(65171),c=r(75337),l=r(27610),u=r(31867),p=r(84275),f=r(32415);async function h(e,t,r){var h;let y,m,w,g,v,S,E;if(!(0,d.default)(e))throw new o.JWEInvalid("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new o.JWEInvalid("JOSE Header missing");if("string"!=typeof e.iv)throw new o.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new o.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new o.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new o.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new o.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new o.JWEInvalid("JWE AAD incorrect type");if(void 0!==e.header&&!(0,d.default)(e.header))throw new o.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!(0,d.default)(e.unprotected))throw new o.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=(0,a.decode)(e.protected);y=JSON.parse(l.decoder.decode(t))}catch{throw new o.JWEInvalid("JWE Protected Header is invalid")}if(!(0,s.default)(y,e.header,e.unprotected))throw new o.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let b={...y,...e.header,...e.unprotected};if((0,p.default)(o.JWEInvalid,new Map,null==r?void 0:r.crit,y,b),void 0!==b.zip){if(!y||!y.zip)throw new o.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==b.zip)throw new o.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:_,enc:J}=b;if("string"!=typeof _||!_)throw new o.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof J||!J)throw new o.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let I=r&&(0,f.default)("keyManagementAlgorithms",r.keyManagementAlgorithms),P=r&&(0,f.default)("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(I&&!I.has(_))throw new o.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(P&&!P.has(J))throw new o.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==e.encrypted_key)try{m=(0,a.decode)(e.encrypted_key)}catch{throw new o.JWEInvalid("Failed to base64url decode the encrypted_key")}let A=!1;"function"==typeof t&&(t=await t(y,e),A=!0);try{w=await (0,c.default)(_,t,m,b,r)}catch(e){if(e instanceof TypeError||e instanceof o.JWEInvalid||e instanceof o.JOSENotSupported)throw e;w=(0,u.default)(J)}try{g=(0,a.decode)(e.iv)}catch{throw new o.JWEInvalid("Failed to base64url decode the iv")}try{v=(0,a.decode)(e.tag)}catch{throw new o.JWEInvalid("Failed to base64url decode the tag")}let C=l.encoder.encode(null!==(h=e.protected)&&void 0!==h?h:"");S=void 0!==e.aad?(0,l.concat)(C,l.encoder.encode("."),l.encoder.encode(e.aad)):C;try{E=(0,a.decode)(e.ciphertext)}catch{throw new o.JWEInvalid("Failed to base64url decode the ciphertext")}let k=await (0,i.default)(J,w,E,g,v,S);"DEF"===b.zip&&(k=await ((null==r?void 0:r.inflateRaw)||n.inflate)(k));let O={plaintext:k};if(void 0!==e.protected&&(O.protectedHeader=y),void 0!==e.aad)try{O.additionalAuthenticatedData=(0,a.decode)(e.aad)}catch{throw new o.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(O.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(O.unprotectedHeader=e.header),A)?{...O,key:t}:O}t.flattenedDecrypt=h},14459:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FlattenedEncrypt=t.unprotected=void 0;let a=r(40049),i=r(86586),n=r(19868),o=r(9920),s=r(14351),d=r(96904),c=r(54006),l=r(27610),u=r(84275);t.unprotected=Symbol(),t.FlattenedEncrypt=class{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,r){let p,f,h,y,m,w,g;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new d.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,c.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new d.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let v={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,u.default)(d.JWEInvalid,new Map,null==r?void 0:r.crit,this._protectedHeader,v),void 0!==v.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new d.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==v.zip)throw new d.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:S,enc:E}=v;if("string"!=typeof S||!S)throw new d.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof E||!E)throw new d.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===S){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===S&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let a;({cek:f,encryptedKey:p,parameters:a}=await (0,s.default)(S,E,e,this._cek,this._keyManagementParameters)),a&&(r&&t.unprotected in r?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...a}:this.setUnprotectedHeader(a):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...a}:this.setProtectedHeader(a))}if(this._iv||(this._iv=(0,o.default)(E)),y=this._protectedHeader?l.encoder.encode((0,a.encode)(JSON.stringify(this._protectedHeader))):l.encoder.encode(""),this._aad?(m=(0,a.encode)(this._aad),h=(0,l.concat)(y,l.encoder.encode("."),l.encoder.encode(m))):h=y,"DEF"===v.zip){let e=await ((null==r?void 0:r.deflateRaw)||n.deflate)(this._plaintext);({ciphertext:w,tag:g}=await (0,i.default)(E,e,f,this._iv,h))}else({ciphertext:w,tag:g}=await (0,i.default)(E,this._plaintext,f,this._iv,h));let b={ciphertext:(0,a.encode)(w),iv:(0,a.encode)(this._iv),tag:(0,a.encode)(g)};return p&&(b.encrypted_key=(0,a.encode)(p)),m&&(b.aad=m),this._protectedHeader&&(b.protected=l.decoder.decode(y)),this._sharedUnprotectedHeader&&(b.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(b.header=this._unprotectedHeader),b}}},39716:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generalDecrypt=void 0;let a=r(48634),i=r(96904),n=r(65171);async function o(e,t,r){if(!(0,n.default)(e))throw new i.JWEInvalid("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(n.default))throw new i.JWEInvalid("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new i.JWEInvalid("JWE Recipients has no members");for(let i of e.recipients)try{return await (0,a.flattenedDecrypt)({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:i.encrypted_key,header:i.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch{}throw new i.JWEDecryptionFailed}t.generalDecrypt=o},91337:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralEncrypt=void 0;let a=r(14459),i=r(96904),n=r(31867),o=r(54006),s=r(14351),d=r(40049),c=r(84275);class l{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.parent.addRecipient(...e)}encrypt(...e){return this.parent.encrypt(...e)}done(){return this.parent}}t.GeneralEncrypt=class{constructor(e){this._recipients=[],this._plaintext=e}addRecipient(e,t){let r=new l(this,e,{crit:null==t?void 0:t.crit});return this._recipients.push(r),r}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}async encrypt(e){var t,r,l;let u;if(!this._recipients.length)throw new i.JWEInvalid("at least one recipient must be added");if(e={deflateRaw:null==e?void 0:e.deflateRaw},1===this._recipients.length){let[t]=this._recipients,r=await new a.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(t.unprotectedHeader).encrypt(t.key,{...t.options,...e}),i={ciphertext:r.ciphertext,iv:r.iv,recipients:[{}],tag:r.tag};return r.aad&&(i.aad=r.aad),r.protected&&(i.protected=r.protected),r.unprotected&&(i.unprotected=r.unprotected),r.encrypted_key&&(i.recipients[0].encrypted_key=r.encrypted_key),r.header&&(i.recipients[0].header=r.header),i}for(let e=0;e<this._recipients.length;e++){let t=this._recipients[e];if(!(0,o.default)(this._protectedHeader,this._unprotectedHeader,t.unprotectedHeader))throw new i.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let r={...this._protectedHeader,...this._unprotectedHeader,...t.unprotectedHeader},{alg:a}=r;if("string"!=typeof a||!a)throw new i.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===a||"ECDH-ES"===a)throw new i.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof r.enc||!r.enc)throw new i.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(u){if(u!==r.enc)throw new i.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else u=r.enc;if((0,c.default)(i.JWEInvalid,new Map,t.options.crit,this._protectedHeader,r),void 0!==r.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new i.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let p=(0,n.default)(u),f={ciphertext:"",iv:"",recipients:[],tag:""};for(let i=0;i<this._recipients.length;i++){let n=this._recipients[i],o={};f.recipients.push(o);let c={...this._protectedHeader,...this._unprotectedHeader,...n.unprotectedHeader},h=c.alg.startsWith("PBES2")?2048+i:void 0;if(0===i){let t=await new a.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(p).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(n.unprotectedHeader).setKeyManagementParameters({p2c:h}).encrypt(n.key,{...n.options,...e,[a.unprotected]:!0});f.ciphertext=t.ciphertext,f.iv=t.iv,f.tag=t.tag,t.aad&&(f.aad=t.aad),t.protected&&(f.protected=t.protected),t.unprotected&&(f.unprotected=t.unprotected),o.encrypted_key=t.encrypted_key,t.header&&(o.header=t.header);continue}let{encryptedKey:y,parameters:m}=await (0,s.default)((null===(t=n.unprotectedHeader)||void 0===t?void 0:t.alg)||(null===(r=this._protectedHeader)||void 0===r?void 0:r.alg)||(null===(l=this._unprotectedHeader)||void 0===l?void 0:l.alg),u,n.key,p,{p2c:h});o.encrypted_key=(0,d.encode)(y),(n.unprotectedHeader||m)&&(o.header={...n.unprotectedHeader,...m})}return f}}},10438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EmbeddedJWK=void 0;let a=r(9501),i=r(65171),n=r(96904);async function o(e,t){let r={...e,...null==t?void 0:t.header};if(!(0,i.default)(r.jwk))throw new n.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let o=await (0,a.importJWK)({...r.jwk,ext:!0},r.alg,!0);if(o instanceof Uint8Array||"public"!==o.type)throw new n.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return o}t.EmbeddedJWK=o},96994:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calculateJwkThumbprintUri=t.calculateJwkThumbprint=void 0;let a=r(66533),i=r(40049),n=r(96904),o=r(27610),s=r(65171),d=(e,t)=>{if("string"!=typeof e||!e)throw new n.JWKInvalid(`${t} missing or invalid`)};async function c(e,t){let r;if(!(0,s.default)(e))throw TypeError("JWK must be an object");if(null!=t||(t="sha256"),"sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":d(e.crv,'"crv" (Curve) Parameter'),d(e.x,'"x" (X Coordinate) Parameter'),d(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":d(e.crv,'"crv" (Subtype of Key Pair) Parameter'),d(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":d(e.e,'"e" (Exponent) Parameter'),d(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":d(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new n.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let c=o.encoder.encode(JSON.stringify(r));return(0,i.encode)(await (0,a.default)(t,c))}async function l(e,t){null!=t||(t="sha256");let r=await c(e,t);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${t.slice(-3)}:${r}`}t.calculateJwkThumbprint=c,t.calculateJwkThumbprintUri=l},7574:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalJWKSet=t.LocalJWKSet=t.isJWKSLike=void 0;let a=r(9501),i=r(96904),n=r(65171);function o(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(s)}function s(e){return(0,n.default)(e)}t.isJWKSLike=o;class d{constructor(e){if(this._cached=new WeakMap,!o(e))throw new i.JWKSInvalid("JSON Web Key Set malformed");this._jwks=function(e){return"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}(e)}async getKey(e,t){let{alg:r,kid:a}={...e,...null==t?void 0:t.header},n=function(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new i.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}(r),o=this._jwks.keys.filter(e=>{let t=n===e.kty;if(t&&"string"==typeof a&&(t=a===e.kid),t&&"string"==typeof e.alg&&(t=r===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t&&"EdDSA"===r&&(t="Ed25519"===e.crv||"Ed448"===e.crv),t)switch(r){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv}return t}),{0:s,length:d}=o;if(0===d)throw new i.JWKSNoMatchingKey;if(1!==d){let e=new i.JWKSMultipleMatchingKeys,{_cached:t}=this;throw e[Symbol.asyncIterator]=async function*(){for(let e of o)try{yield await c(t,e,r)}catch{continue}},e}return c(this._cached,s,r)}}async function c(e,t,r){let n=e.get(t)||e.set(t,{}).get(t);if(void 0===n[r]){let e=await (0,a.importJWK)({...t,ext:!0},r);if(e instanceof Uint8Array||"public"!==e.type)throw new i.JWKSInvalid("JSON Web Key Set members must be public keys");n[r]=e}return n[r]}t.LocalJWKSet=d,t.createLocalJWKSet=function(e){let t=new d(e);return async function(e,r){return t.getKey(e,r)}}},66245:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createRemoteJWKSet=void 0;let a=r(18642),i=r(96904),n=r(7574);class o extends n.LocalJWKSet{constructor(e,t){if(super({keys:[]}),this._jwks=void 0,!(e instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:null==t?void 0:t.agent,headers:null==t?void 0:t.headers},this._timeoutDuration="number"==typeof(null==t?void 0:t.timeoutDuration)?null==t?void 0:t.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==t?void 0:t.cooldownDuration)?null==t?void 0:t.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==t?void 0:t.cacheMaxAge)?null==t?void 0:t.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(e,t){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(e,t)}catch(r){if(r instanceof i.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(e,t);throw r}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=(0,a.default)(this._url,this._timeoutDuration,this._options).then(e=>{if(!(0,n.isJWKSLike)(e))throw new i.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:e.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}}t.createRemoteJWKSet=function(e,t){let r=new o(e,t);return async function(e,t){return r.getKey(e,t)}}},14504:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CompactSign=void 0;let a=r(88515);t.CompactSign=class{constructor(e){this._flattened=new a.FlattenedSign(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){let r=await this._flattened.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}},82863:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.compactVerify=void 0;let a=r(82558),i=r(96904),n=r(27610);async function o(e,t,r){if(e instanceof Uint8Array&&(e=n.decoder.decode(e)),"string"!=typeof e)throw new i.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:o,1:s,2:d,length:c}=e.split(".");if(3!==c)throw new i.JWSInvalid("Invalid Compact JWS");let l=await (0,a.flattenedVerify)({payload:s,protected:o,signature:d},t,r),u={payload:l.payload,protectedHeader:l.protectedHeader};return"function"==typeof t?{...u,key:l.key}:u}t.compactVerify=o},88515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FlattenedSign=void 0;let a=r(40049),i=r(69030),n=r(54006),o=r(96904),s=r(27610),d=r(92903),c=r(84275);t.FlattenedSign=class{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){let r;if(!this._protectedHeader&&!this._unprotectedHeader)throw new o.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,n.default)(this._protectedHeader,this._unprotectedHeader))throw new o.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let l={...this._protectedHeader,...this._unprotectedHeader},u=(0,c.default)(o.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this._protectedHeader,l),p=!0;if(u.has("b64")&&"boolean"!=typeof(p=this._protectedHeader.b64))throw new o.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:f}=l;if("string"!=typeof f||!f)throw new o.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,d.default)(f,e,"sign");let h=this._payload;p&&(h=s.encoder.encode((0,a.encode)(h))),r=this._protectedHeader?s.encoder.encode((0,a.encode)(JSON.stringify(this._protectedHeader))):s.encoder.encode("");let y=(0,s.concat)(r,s.encoder.encode("."),h),m=await (0,i.default)(f,e,y),w={signature:(0,a.encode)(m),payload:""};return p&&(w.payload=s.decoder.decode(h)),this._unprotectedHeader&&(w.header=this._unprotectedHeader),this._protectedHeader&&(w.protected=s.decoder.decode(r)),w}}},82558:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.flattenedVerify=void 0;let a=r(40049),i=r(76821),n=r(96904),o=r(27610),s=r(54006),d=r(65171),c=r(92903),l=r(84275),u=r(32415);async function p(e,t,r){var p;let f,h;if(!(0,d.default)(e))throw new n.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new n.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new n.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new n.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new n.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,d.default)(e.header))throw new n.JWSInvalid("JWS Unprotected Header incorrect type");let y={};if(e.protected)try{let t=(0,a.decode)(e.protected);y=JSON.parse(o.decoder.decode(t))}catch{throw new n.JWSInvalid("JWS Protected Header is invalid")}if(!(0,s.default)(y,e.header))throw new n.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let m={...y,...e.header},w=(0,l.default)(n.JWSInvalid,new Map([["b64",!0]]),null==r?void 0:r.crit,y,m),g=!0;if(w.has("b64")&&"boolean"!=typeof(g=y.b64))throw new n.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:v}=m;if("string"!=typeof v||!v)throw new n.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let S=r&&(0,u.default)("algorithms",r.algorithms);if(S&&!S.has(v))throw new n.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(g){if("string"!=typeof e.payload)throw new n.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new n.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let E=!1;"function"==typeof t&&(t=await t(y,e),E=!0),(0,c.default)(v,t,"verify");let b=(0,o.concat)(o.encoder.encode(null!==(p=e.protected)&&void 0!==p?p:""),o.encoder.encode("."),"string"==typeof e.payload?o.encoder.encode(e.payload):e.payload);try{f=(0,a.decode)(e.signature)}catch{throw new n.JWSInvalid("Failed to base64url decode the signature")}let _=await (0,i.default)(v,t,f,b);if(!_)throw new n.JWSSignatureVerificationFailed;if(g)try{h=(0,a.decode)(e.payload)}catch{throw new n.JWSInvalid("Failed to base64url decode the payload")}else h="string"==typeof e.payload?o.encoder.encode(e.payload):e.payload;let J={payload:h};return(void 0!==e.protected&&(J.protectedHeader=y),void 0!==e.header&&(J.unprotectedHeader=e.header),E)?{...J,key:t}:J}t.flattenedVerify=p},72293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralSign=void 0;let a=r(88515),i=r(96904);class n{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setProtectedHeader(e){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.parent.addSignature(...e)}sign(...e){return this.parent.sign(...e)}done(){return this.parent}}t.GeneralSign=class{constructor(e){this._signatures=[],this._payload=e}addSignature(e,t){let r=new n(this,e,t);return this._signatures.push(r),r}async sign(){if(!this._signatures.length)throw new i.JWSInvalid("at least one signature must be added");let e={signatures:[],payload:""};for(let t=0;t<this._signatures.length;t++){let r=this._signatures[t],n=new a.FlattenedSign(this._payload);n.setProtectedHeader(r.protectedHeader),n.setUnprotectedHeader(r.unprotectedHeader);let{payload:o,...s}=await n.sign(r.key,r.options);if(0===t)e.payload=o;else if(e.payload!==o)throw new i.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");e.signatures.push(s)}return e}}},89778:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generalVerify=void 0;let a=r(82558),i=r(96904),n=r(65171);async function o(e,t,r){if(!(0,n.default)(e))throw new i.JWSInvalid("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(n.default))throw new i.JWSInvalid("JWS Signatures missing or incorrect type");for(let i of e.signatures)try{return await (0,a.flattenedVerify)({header:i.header,payload:e.payload,protected:i.protected,signature:i.signature},t,r)}catch{}throw new i.JWSSignatureVerificationFailed}t.generalVerify=o},73220:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.jwtDecrypt=void 0;let a=r(14846),i=r(85170),n=r(96904);async function o(e,t,r){let o=await (0,a.compactDecrypt)(e,t,r),s=(0,i.default)(o.protectedHeader,o.plaintext,r),{protectedHeader:d}=o;if(void 0!==d.iss&&d.iss!==s.iss)throw new n.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==d.sub&&d.sub!==s.sub)throw new n.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==d.aud&&JSON.stringify(d.aud)!==JSON.stringify(s.aud))throw new n.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let c={payload:s,protectedHeader:d};return"function"==typeof t?{...c,key:o.key}:c}t.jwtDecrypt=o},78259:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptJWT=void 0;let a=r(82814),i=r(27610),n=r(48027);class o extends n.ProduceJWT{setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){let r=new a.CompactEncrypt(i.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}}t.EncryptJWT=o},48027:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProduceJWT=void 0;let a=r(27578),i=r(65171),n=r(81939);t.ProduceJWT=class{constructor(e){if(!(0,i.default)(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:e}:this._payload={...this._payload,nbf:(0,a.default)(new Date)+(0,n.default)(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:e}:this._payload={...this._payload,exp:(0,a.default)(new Date)+(0,n.default)(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:(0,a.default)(new Date)}:this._payload={...this._payload,iat:e},this}}},52886:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SignJWT=void 0;let a=r(14504),i=r(96904),n=r(27610),o=r(48027);class s extends o.ProduceJWT{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;let o=new a.CompactSign(n.encoder.encode(JSON.stringify(this._payload)));if(o.setProtectedHeader(this._protectedHeader),Array.isArray(null===(r=this._protectedHeader)||void 0===r?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new i.JWTInvalid("JWTs MUST NOT use unencoded payload");return o.sign(e,t)}}t.SignJWT=s},48208:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnsecuredJWT=void 0;let a=r(40049),i=r(27610),n=r(96904),o=r(85170),s=r(48027);class d extends s.ProduceJWT{encode(){let e=a.encode(JSON.stringify({alg:"none"})),t=a.encode(JSON.stringify(this._payload));return`${e}.${t}.`}static decode(e,t){let r;if("string"!=typeof e)throw new n.JWTInvalid("Unsecured JWT must be a string");let{0:s,1:d,2:c,length:l}=e.split(".");if(3!==l||""!==c)throw new n.JWTInvalid("Invalid Unsecured JWT");try{if(r=JSON.parse(i.decoder.decode(a.decode(s))),"none"!==r.alg)throw Error()}catch{throw new n.JWTInvalid("Invalid Unsecured JWT")}let u=(0,o.default)(r,a.decode(d),t);return{payload:u,header:r}}}t.UnsecuredJWT=d},73354:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.jwtVerify=void 0;let a=r(82863),i=r(85170),n=r(96904);async function o(e,t,r){var o;let s=await (0,a.compactVerify)(e,t,r);if((null===(o=s.protectedHeader.crit)||void 0===o?void 0:o.includes("b64"))&&!1===s.protectedHeader.b64)throw new n.JWTInvalid("JWTs MUST NOT use unencoded payload");let d=(0,i.default)(s.protectedHeader,s.payload,r),c={payload:d,protectedHeader:s.protectedHeader};return"function"==typeof t?{...c,key:s.key}:c}t.jwtVerify=o},73640:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exportJWK=t.exportPKCS8=t.exportSPKI=void 0;let a=r(39764),i=r(39764),n=r(40752);async function o(e){return(0,a.toSPKI)(e)}async function s(e){return(0,i.toPKCS8)(e)}async function d(e){return(0,n.default)(e)}t.exportSPKI=o,t.exportPKCS8=s,t.exportJWK=d},63158:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyPair=void 0;let a=r(82090);async function i(e,t){return(0,a.generateKeyPair)(e,t)}t.generateKeyPair=i},96505:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateSecret=void 0;let a=r(82090);async function i(e,t){return(0,a.generateSecret)(e,t)}t.generateSecret=i},9501:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importJWK=t.importPKCS8=t.importX509=t.importSPKI=void 0;let a=r(40049),i=r(39764),n=r(44557),o=r(96904),s=r(65171);async function d(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,i.fromSPKI)(e,t,r)}async function c(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,i.fromX509)(e,t,r)}async function l(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,i.fromPKCS8)(e,t,r)}async function u(e,t,r){var i;if(!(0,s.default)(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=r||(r=!0!==e.ext),r)return(0,n.default)({...e,alg:t,ext:null!==(i=e.ext)&&void 0!==i&&i});return(0,a.decode)(e.k);case"RSA":if(void 0!==e.oth)throw new o.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,n.default)({...e,alg:t});default:throw new o.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}t.importSPKI=d,t.importX509=c,t.importPKCS8=l,t.importJWK=u},40318:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=t.wrap=void 0;let a=r(86586),i=r(49810),n=r(9920),o=r(40049);async function s(e,t,r,i){let s=e.slice(0,7);i||(i=(0,n.default)(s));let{ciphertext:d,tag:c}=await (0,a.default)(s,r,t,i,new Uint8Array(0));return{encryptedKey:d,iv:(0,o.encode)(i),tag:(0,o.encode)(c)}}async function d(e,t,r,a,n){let o=e.slice(0,7);return(0,i.default)(o,t,r,a,n,new Uint8Array(0))}t.wrap=s,t.unwrap=d},27610:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.concatKdf=t.lengthAndInput=t.uint32be=t.uint64be=t.p2s=t.concat=t.decoder=t.encoder=void 0;let a=r(66533);function i(...e){let t=e.reduce((e,{length:t})=>e+t,0),r=new Uint8Array(t),a=0;return e.forEach(e=>{r.set(e,a),a+=e.length}),r}function n(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function o(e){let t=new Uint8Array(4);return n(t,e),t}async function s(e,t,r){let i=Math.ceil((t>>3)/32),n=new Uint8Array(32*i);for(let t=0;t<i;t++){let i=new Uint8Array(4+e.length+r.length);i.set(o(t+1)),i.set(e,4),i.set(r,4+e.length),n.set(await (0,a.default)("sha256",i),32*t)}return n.slice(0,t>>3)}t.encoder=new TextEncoder,t.decoder=new TextDecoder,t.concat=i,t.p2s=function(e,r){return i(t.encoder.encode(e),new Uint8Array([0]),r)},t.uint64be=function(e){let t=new Uint8Array(8);return n(t,Math.floor(e/4294967296),0),n(t,e%4294967296,4),t},t.uint32be=o,t.lengthAndInput=function(e){return i(o(e.length),e)},t.concatKdf=s},31867:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bitLength=void 0;let a=r(96904),i=r(25131);function n(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new a.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}t.bitLength=n,t.default=e=>(0,i.default)(new Uint8Array(n(e)>>3))},71696:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(96904),i=r(9920);t.default=(e,t)=>{if(t.length<<3!==(0,i.bitLength)(e))throw new a.JWEInvalid("Invalid Initialization Vector length")}},92903:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(79176),i=r(51790),n=(e,t)=>{if(!(t instanceof Uint8Array)){if(!(0,i.default)(t))throw TypeError((0,a.withAlg)(e,t,...i.types,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${i.types.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},o=(e,t,r)=>{if(!(0,i.default)(t))throw TypeError((0,a.withAlg)(e,t,...i.types));if("secret"===t.type)throw TypeError(`${i.types.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${i.types.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${i.types.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${i.types.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${i.types.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)};t.default=(e,t,r)=>{let a=e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e);a?n(e,t):o(e,t,r)}},78902:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(96904);t.default=function(e){if(!(e instanceof Uint8Array)||e.length<8)throw new a.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}},74637:(e,t)=>{function r(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function a(e,t){return e.name===t}function i(e){return parseInt(e.name.slice(4),10)}function n(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.checkEncCryptoKey=t.checkSigCryptoKey=void 0,t.checkSigCryptoKey=function(e,t,...o){switch(t){case"HS256":case"HS384":case"HS512":{if(!a(e.algorithm,"HMAC"))throw r("HMAC");let n=parseInt(t.slice(2),10),o=i(e.algorithm.hash);if(o!==n)throw r(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!a(e.algorithm,"RSASSA-PKCS1-v1_5"))throw r("RSASSA-PKCS1-v1_5");let n=parseInt(t.slice(2),10),o=i(e.algorithm.hash);if(o!==n)throw r(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!a(e.algorithm,"RSA-PSS"))throw r("RSA-PSS");let n=parseInt(t.slice(2),10),o=i(e.algorithm.hash);if(o!==n)throw r(`SHA-${n}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw r("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!a(e.algorithm,"ECDSA"))throw r("ECDSA");let i=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}(t),n=e.algorithm.namedCurve;if(n!==i)throw r(i,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}n(e,o)},t.checkEncCryptoKey=function(e,t,...o){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!a(e.algorithm,"AES-GCM"))throw r("AES-GCM");let i=parseInt(t.slice(1,4),10),n=e.algorithm.length;if(n!==i)throw r(i,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!a(e.algorithm,"AES-KW"))throw r("AES-KW");let i=parseInt(t.slice(1,4),10),n=e.algorithm.length;if(n!==i)throw r(i,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw r("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!a(e.algorithm,"PBKDF2"))throw r("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!a(e.algorithm,"RSA-OAEP"))throw r("RSA-OAEP");let n=parseInt(t.slice(9),10)||1,o=i(e.algorithm.hash);if(o!==n)throw r(`SHA-${n}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}n(e,o)}},75337:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(80015),i=r(11715),n=r(71760),o=r(15368),s=r(40049),d=r(96904),c=r(31867),l=r(9501),u=r(92903),p=r(65171),f=r(40318);async function h(e,t,r,h,y){switch((0,u.default)(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new d.JWEInvalid("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new d.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let n,o;if(!(0,p.default)(h.epk))throw new d.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!i.ecdhAllowed(t))throw new d.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let u=await (0,l.importJWK)(h.epk,e);if(void 0!==h.apu){if("string"!=typeof h.apu)throw new d.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{n=(0,s.decode)(h.apu)}catch{throw new d.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==h.apv){if("string"!=typeof h.apv)throw new d.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{o=(0,s.decode)(h.apv)}catch{throw new d.JWEInvalid("Failed to base64url decode the apv")}}let f=await i.deriveKey(u,t,"ECDH-ES"===e?h.enc:e,"ECDH-ES"===e?(0,c.bitLength)(h.enc):parseInt(e.slice(-5,-2),10),n,o);if("ECDH-ES"===e)return f;if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");return(0,a.unwrap)(e.slice(-6),f,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");return(0,o.decrypt)(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let a;if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof h.p2c)throw new d.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let i=(null==y?void 0:y.maxPBES2Count)||1e4;if(h.p2c>i)throw new d.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof h.p2s)throw new d.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{a=(0,s.decode)(h.p2s)}catch{throw new d.JWEInvalid("Failed to base64url decode the p2s")}return(0,n.decrypt)(e,t,r,h.p2c,a)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");return(0,a.unwrap)(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let a,i;if(void 0===r)throw new d.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof h.iv)throw new d.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof h.tag)throw new d.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{a=(0,s.decode)(h.iv)}catch{throw new d.JWEInvalid("Failed to base64url decode the iv")}try{i=(0,s.decode)(h.tag)}catch{throw new d.JWEInvalid("Failed to base64url decode the tag")}return(0,f.unwrap)(e,t,r,a,i)}default:throw new d.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}t.default=h},14351:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(80015),i=r(11715),n=r(71760),o=r(15368),s=r(40049),d=r(31867),c=r(96904),l=r(73640),u=r(92903),p=r(40318);async function f(e,t,r,f,h={}){let y,m,w;switch((0,u.default)(e,r,"encrypt"),e){case"dir":w=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!i.ecdhAllowed(r))throw new c.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:n,apv:o}=h,{epk:u}=h;u||(u=(await i.generateEpk(r)).privateKey);let{x:p,y:g,crv:v,kty:S}=await (0,l.exportJWK)(u),E=await i.deriveKey(r,u,"ECDH-ES"===e?t:e,"ECDH-ES"===e?(0,d.bitLength)(t):parseInt(e.slice(-5,-2),10),n,o);if(m={epk:{x:p,crv:v,kty:S}},"EC"===S&&(m.epk.y=g),n&&(m.apu=(0,s.encode)(n)),o&&(m.apv=(0,s.encode)(o)),"ECDH-ES"===e){w=E;break}w=f||(0,d.default)(t);let b=e.slice(-6);y=await (0,a.wrap)(b,E,w);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":w=f||(0,d.default)(t),y=await (0,o.encrypt)(e,r,w);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{w=f||(0,d.default)(t);let{p2c:a,p2s:i}=h;({encryptedKey:y,...m}=await (0,n.encrypt)(e,r,w,a,i));break}case"A128KW":case"A192KW":case"A256KW":w=f||(0,d.default)(t),y=await (0,a.wrap)(e,r,w);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{w=f||(0,d.default)(t);let{iv:a}=h;({encryptedKey:y,...m}=await (0,p.wrap)(e,r,w,a));break}default:throw new c.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:w,encryptedKey:y,parameters:m}}t.default=f},27578:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>Math.floor(e.getTime()/1e3)},79176:(e,t)=>{function r(e,t,...a){if(a.length>2){let t=a.pop();e+=`one of type ${a.join(", ")}, or ${t}.`}else 2===a.length?e+=`one of type ${a[0]} or ${a[1]}.`:e+=`of type ${a[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}Object.defineProperty(t,"__esModule",{value:!0}),t.withAlg=void 0,t.default=(e,...t)=>r("Key must be ",e,...t),t.withAlg=function(e,t,...a){return r(`Key for the ${e} algorithm must be `,t,...a)}},54006:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0}},65171:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},9920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bitLength=void 0;let a=r(96904),i=r(25131);function n(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new a.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}t.bitLength=n,t.default=e=>(0,i.default)(new Uint8Array(n(e)>>3))},85170:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(96904),i=r(27610),n=r(27578),o=r(81939),s=r(65171),d=e=>e.toLowerCase().replace(/^application\//,""),c=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));t.default=(e,t,r={})=>{let l,u;let{typ:p}=r;if(p&&("string"!=typeof e.typ||d(e.typ)!==d(p)))throw new a.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{l=JSON.parse(i.decoder.decode(t))}catch{}if(!(0,s.default)(l))throw new a.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:f=[],issuer:h,subject:y,audience:m,maxTokenAge:w}=r;for(let e of(void 0!==w&&f.push("iat"),void 0!==m&&f.push("aud"),void 0!==y&&f.push("sub"),void 0!==h&&f.push("iss"),new Set(f.reverse())))if(!(e in l))throw new a.JWTClaimValidationFailed(`missing required "${e}" claim`,e,"missing");if(h&&!(Array.isArray(h)?h:[h]).includes(l.iss))throw new a.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(y&&l.sub!==y)throw new a.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(m&&!c(l.aud,"string"==typeof m?[m]:m))throw new a.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof r.clockTolerance){case"string":u=(0,o.default)(r.clockTolerance);break;case"number":u=r.clockTolerance;break;case"undefined":u=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:g}=r,v=(0,n.default)(g||new Date);if((void 0!==l.iat||w)&&"number"!=typeof l.iat)throw new a.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==l.nbf){if("number"!=typeof l.nbf)throw new a.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(l.nbf>v+u)throw new a.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==l.exp){if("number"!=typeof l.exp)throw new a.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(l.exp<=v-u)throw new a.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(w){let e=v-l.iat,t="number"==typeof w?w:(0,o.default)(w);if(e-u>t)throw new a.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-u)throw new a.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return l}},81939:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});let r=604800,a=31557600,i=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;t.default=e=>{let t=i.exec(e);if(!t)throw TypeError("Invalid time period format");let n=parseFloat(t[1]),o=t[2].toLowerCase();switch(o){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(n);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*n);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*n);case"day":case"days":case"d":return Math.round(86400*n);case"week":case"weeks":case"w":return Math.round(n*r);default:return Math.round(n*a)}}},32415:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}},84275:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(96904);t.default=function(e,t,r,i,n){let o;if(void 0!==n.crit&&void 0===i.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||void 0===i.crit)return new Set;if(!Array.isArray(i.crit)||0===i.crit.length||i.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let s of(o=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,i.crit)){if(!o.has(s))throw new a.JOSENotSupported(`Extension Header Parameter "${s}" is not recognized`);if(void 0===n[s])throw new e(`Extension Header Parameter "${s}" is missing`);if(o.get(s)&&void 0===i[s])throw new e(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(i.crit)}},80015:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=t.wrap=void 0;let a=r(14300),i=r(6113),n=r(96904),o=r(27610),s=r(81501),d=r(74637),c=r(50019),l=r(79176),u=r(3554),p=r(51790);function f(e,t){if(e.symmetricKeySize<<3!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function h(e,t,r){if((0,c.default)(e))return e;if(e instanceof Uint8Array)return(0,i.createSecretKey)(e);if((0,s.isCryptoKey)(e))return(0,d.checkEncCryptoKey)(e,t,r),i.KeyObject.from(e);throw TypeError((0,l.default)(e,...p.types,"Uint8Array"))}t.wrap=(e,t,r)=>{let s=parseInt(e.slice(1,4),10),d=`aes${s}-wrap`;if(!(0,u.default)(d))throw new n.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`);let c=h(t,e,"wrapKey");f(c,e);let l=(0,i.createCipheriv)(d,c,a.Buffer.alloc(8,166));return(0,o.concat)(l.update(r),l.final())},t.unwrap=(e,t,r)=>{let s=parseInt(e.slice(1,4),10),d=`aes${s}-wrap`;if(!(0,u.default)(d))throw new n.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`);let c=h(t,e,"unwrapKey");f(c,e);let l=(0,i.createDecipheriv)(d,c,a.Buffer.alloc(8,166));return(0,o.concat)(l.update(r),l.final())}},39764:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fromX509=t.fromSPKI=t.fromPKCS8=t.toPKCS8=t.toSPKI=void 0;let a=r(6113),i=r(14300),n=r(81501),o=r(50019),s=r(79176),d=r(51790),c=(e,t,r)=>{let i;if((0,n.isCryptoKey)(r)){if(!r.extractable)throw TypeError("CryptoKey is not extractable");i=a.KeyObject.from(r)}else if((0,o.default)(r))i=r;else throw TypeError((0,s.default)(r,...d.types));if(i.type!==e)throw TypeError(`key is not a ${e} key`);return i.export({format:"pem",type:t})};t.toSPKI=e=>c("public","spki",e),t.toPKCS8=e=>c("private","pkcs8",e),t.fromPKCS8=e=>(0,a.createPrivateKey)({key:i.Buffer.from(e.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),t.fromSPKI=e=>(0,a.createPublicKey)({key:i.Buffer.from(e.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),t.fromX509=e=>(0,a.createPublicKey)({key:e,type:"spki",format:"pem"})},21026:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){if(48!==e[0])throw TypeError();this.buffer=e,this.offset=1;let t=this.decodeLength();if(t!==e.length-this.offset)throw TypeError()}decodeLength(){let e=this.buffer[this.offset++];if(128&e){let t=-129&e;e=0;for(let r=0;r<t;r++)e=e<<8|this.buffer[this.offset+r];this.offset+=t}return e}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let e=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,e--);let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}end(){if(this.offset!==this.buffer.length)throw TypeError()}}},35725:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(14300),i=r(96904),n=a.Buffer.from([0]),o=a.Buffer.from([2]),s=a.Buffer.from([3]),d=a.Buffer.from([48]),c=a.Buffer.from([4]),l=e=>{if(e<128)return a.Buffer.from([e]);let t=a.Buffer.alloc(5);t.writeUInt32BE(e,1);let r=1;for(;0===t[r];)r++;return t[r-1]=128|5-r,t.slice(r-1)},u=new Map([["P-256",a.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",a.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",a.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",a.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",a.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",a.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",a.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",a.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",a.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);t.default=class{constructor(){this.length=0,this.elements=[]}oidFor(e){let t=u.get(e);if(!t)throw new i.JOSENotSupported("Invalid or unsupported OID");this.elements.push(t),this.length+=t.length}zero(){this.elements.push(o,a.Buffer.from([1]),n),this.length+=3}one(){this.elements.push(o,a.Buffer.from([1]),a.Buffer.from([1])),this.length+=3}unsignedInteger(e){if(128&e[0]){let t=l(e.length+1);this.elements.push(o,t,n,e),this.length+=2+t.length+e.length}else{let t=0;for(;0===e[t]&&(128&e[t+1])==0;)t++;let r=l(e.length-t);this.elements.push(o,l(e.length-t),e.slice(t)),this.length+=1+r.length+e.length-t}}octStr(e){let t=l(e.length);this.elements.push(c,l(e.length),e),this.length+=1+t.length+e.length}bitStr(e){let t=l(e.length+1);this.elements.push(s,l(e.length+1),n,e),this.length+=1+t.length+e.length+1}add(e){this.elements.push(e),this.length+=e.length}end(e=d){let t=l(this.length);return a.Buffer.concat([e,t,...this.elements],1+t.length+this.length)}}},40049:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=t.encodeBase64=t.decodeBase64=void 0;let a=r(14300),i=r(27610);a.Buffer.isEncoding("base64url")?t.encode=e=>a.Buffer.from(e).toString("base64url"):t.encode=e=>a.Buffer.from(e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),t.decodeBase64=e=>a.Buffer.from(e,"base64"),t.encodeBase64=e=>a.Buffer.from(e).toString("base64"),t.decode=e=>a.Buffer.from(function(e){let t=e;return t instanceof Uint8Array&&(t=i.decoder.decode(t)),t}(e),"base64")},24200:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),i=r(27610);t.default=function(e,t,r,n,o,s){let d=(0,i.concat)(e,t,r,(0,i.uint64be)(e.length<<3)),c=(0,a.createHmac)(`sha${n}`,o);return c.update(d),c.digest().slice(0,s>>3)}},93853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(96904),i=r(50019);t.default=(e,t)=>{let r;switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new a.JOSENotSupported(`Content Encryption Algorithm ${e} is not supported either by JOSE or your javascript runtime`)}if(t instanceof Uint8Array){let e=t.byteLength<<3;if(e!==r)throw new a.JWEInvalid(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}if((0,i.default)(t)&&"secret"===t.type){let e=t.symmetricKeySize<<3;if(e!==r)throw new a.JWEInvalid(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},70052:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModulusLength=t.weakMap=void 0,t.weakMap=new WeakMap;let r=(e,t)=>{let a=e.readUInt8(1);if((128&a)==0)return 0===t?a:r(e.subarray(2+a),t-1);let i=127&a;a=0;for(let t=0;t<i;t++){a<<=8;let r=e.readUInt8(2+t);a|=r}return 0===t?a:r(e.subarray(2+a),t-1)},a=(e,t)=>{let a=e.readUInt8(1);return(128&a)==0?r(e.subarray(2),t):r(e.subarray(2+(127&a)),t)},i=e=>{var r,i;if(t.weakMap.has(e))return t.weakMap.get(e);let n=null!==(i=null===(r=e.asymmetricKeyDetails)||void 0===r?void 0:r.modulusLength)&&void 0!==i?i:a(e.export({format:"der",type:"pkcs1"}),"private"===e.type?1:0)-1<<3;return t.weakMap.set(e,n),n};t.setModulusLength=(e,r)=>{t.weakMap.set(e,r)},t.default=(e,t)=>{if(2048>i(e))throw TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}},3554:(e,t,r)=>{let a;Object.defineProperty(t,"__esModule",{value:!0});let i=r(6113);t.default=e=>(a||(a=new Set((0,i.getCiphers)())),a.has(e))},49810:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),i=r(71696),n=r(93853),o=r(27610),s=r(96904),d=r(4820),c=r(24200),l=r(81501),u=r(74637),p=r(50019),f=r(79176),h=r(3554),y=r(51790);t.default=(e,t,r,m,w,g)=>{let v;if((0,l.isCryptoKey)(t))(0,u.checkEncCryptoKey)(t,e,"decrypt"),v=a.KeyObject.from(t);else if(t instanceof Uint8Array||(0,p.default)(t))v=t;else throw TypeError((0,f.default)(t,...y.types,"Uint8Array"));switch((0,n.default)(e,v),(0,i.default)(e,m),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,i,n,l){let u,f;let y=parseInt(e.slice(1,4),10);(0,p.default)(t)&&(t=t.export());let m=t.subarray(y>>3),w=t.subarray(0,y>>3),g=parseInt(e.slice(-3),10),v=`aes-${y}-cbc`;if(!(0,h.default)(v))throw new s.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let S=(0,c.default)(l,i,r,g,w,y);try{u=(0,d.default)(n,S)}catch{}if(!u)throw new s.JWEDecryptionFailed;try{let e=(0,a.createDecipheriv)(v,m,i);f=(0,o.concat)(e.update(r),e.final())}catch{}if(!f)throw new s.JWEDecryptionFailed;return f}(e,v,r,m,w,g);case"A128GCM":case"A192GCM":case"A256GCM":return function(e,t,r,i,n,o){let d=parseInt(e.slice(1,4),10),c=`aes-${d}-gcm`;if(!(0,h.default)(c))throw new s.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);try{let e=(0,a.createDecipheriv)(c,t,i,{authTagLength:16});e.setAuthTag(n),o.byteLength&&e.setAAD(o,{plaintextLength:r.length});let s=e.update(r);return e.final(),s}catch{throw new s.JWEDecryptionFailed}}(e,v,r,m,w,g);default:throw new s.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},66533:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113);t.default=(e,t)=>(0,a.createHash)(e).update(t).digest()},96324:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(96904);t.default=function(e){switch(e){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new a.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},11715:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ecdhAllowed=t.generateEpk=t.deriveKey=void 0;let a=r(6113),i=r(73837),n=r(92031),o=r(27610),s=r(96904),d=r(81501),c=r(74637),l=r(50019),u=r(79176),p=r(51790),f=(0,i.promisify)(a.generateKeyPair);async function h(e,t,r,i,n=new Uint8Array(0),s=new Uint8Array(0)){let f,h;if((0,d.isCryptoKey)(e))(0,c.checkEncCryptoKey)(e,"ECDH"),f=a.KeyObject.from(e);else if((0,l.default)(e))f=e;else throw TypeError((0,u.default)(e,...p.types));if((0,d.isCryptoKey)(t))(0,c.checkEncCryptoKey)(t,"ECDH","deriveBits"),h=a.KeyObject.from(t);else if((0,l.default)(t))h=t;else throw TypeError((0,u.default)(t,...p.types));let y=(0,o.concat)((0,o.lengthAndInput)(o.encoder.encode(r)),(0,o.lengthAndInput)(n),(0,o.lengthAndInput)(s),(0,o.uint32be)(i)),m=(0,a.diffieHellman)({privateKey:h,publicKey:f});return(0,o.concatKdf)(m,i,y)}async function y(e){let t;if((0,d.isCryptoKey)(e))t=a.KeyObject.from(e);else if((0,l.default)(e))t=e;else throw TypeError((0,u.default)(e,...p.types));switch(t.asymmetricKeyType){case"x25519":return f("x25519");case"x448":return f("x448");case"ec":{let e=(0,n.default)(t);return f("ec",{namedCurve:e})}default:throw new s.JOSENotSupported("Invalid or unsupported EPK")}}t.deriveKey=h,t.generateEpk=y,t.ecdhAllowed=e=>["P-256","P-384","P-521","X25519","X448"].includes((0,n.default)(e))},86586:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),i=r(71696),n=r(93853),o=r(27610),s=r(24200),d=r(81501),c=r(74637),l=r(50019),u=r(79176),p=r(96904),f=r(3554),h=r(51790);t.default=(e,t,r,y,m)=>{let w;if((0,d.isCryptoKey)(r))(0,c.checkEncCryptoKey)(r,e,"encrypt"),w=a.KeyObject.from(r);else if(r instanceof Uint8Array||(0,l.default)(r))w=r;else throw TypeError((0,u.default)(r,...h.types,"Uint8Array"));switch((0,n.default)(e,w),(0,i.default)(e,y),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return function(e,t,r,i,n){let d=parseInt(e.slice(1,4),10);(0,l.default)(r)&&(r=r.export());let c=r.subarray(d>>3),u=r.subarray(0,d>>3),h=`aes-${d}-cbc`;if(!(0,f.default)(h))throw new p.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let y=(0,a.createCipheriv)(h,c,i),m=(0,o.concat)(y.update(t),y.final()),w=parseInt(e.slice(-3),10),g=(0,s.default)(n,i,m,w,u,d);return{ciphertext:m,tag:g}}(e,t,w,y,m);case"A128GCM":case"A192GCM":case"A256GCM":return function(e,t,r,i,n){let o=parseInt(e.slice(1,4),10),s=`aes-${o}-gcm`;if(!(0,f.default)(s))throw new p.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let d=(0,a.createCipheriv)(s,r,i,{authTagLength:16});n.byteLength&&d.setAAD(n,{plaintextLength:t.length});let c=d.update(t);d.final();let l=d.getAuthTag();return{ciphertext:c,tag:l}}(e,t,w,y,m);default:throw new p.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},18642:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(13685),i=r(95687),n=r(82361),o=r(96904),s=r(27610),d=async(e,t,r)=>{let d;switch(e.protocol){case"https:":d=i.get;break;case"http:":d=a.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:c,headers:l}=r,u=d(e.href,{agent:c,timeout:t,headers:l}),[p]=await Promise.race([(0,n.once)(u,"response"),(0,n.once)(u,"timeout")]);if(!p)throw u.destroy(),new o.JWKSTimeout;if(200!==p.statusCode)throw new o.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let f=[];for await(let e of p)f.push(e);try{return JSON.parse(s.decoder.decode((0,s.concat)(...f)))}catch{throw new o.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}};t.default=d},19440:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.jwkImport=t.jwkExport=t.rsaPssParams=t.oneShotCallback=void 0;let[r,a]=process.versions.node.split(".").map(e=>parseInt(e,10));t.oneShotCallback=r>=16||15===r&&a>=13,t.rsaPssParams=!("electron"in process.versions)&&(r>=17||16===r&&a>=9),t.jwkExport=r>=16||15===r&&a>=9,t.jwkImport=r>=16||15===r&&a>=12},82090:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyPair=t.generateSecret=void 0;let a=r(6113),i=r(73837),n=r(25131),o=r(70052),s=r(96904),d=(0,i.promisify)(a.generateKeyPair);async function c(e,t){let r;switch(e){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new s.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,a.createSecretKey)((0,n.default)(new Uint8Array(r>>3)))}async function l(e,t){var r,a;switch(e){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let e=null!==(r=null==t?void 0:t.modulusLength)&&void 0!==r?r:2048;if("number"!=typeof e||e<2048)throw new s.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let a=await d("rsa",{modulusLength:e,publicExponent:65537});return(0,o.setModulusLength)(a.privateKey,e),(0,o.setModulusLength)(a.publicKey,e),a}case"ES256":return d("ec",{namedCurve:"P-256"});case"ES256K":return d("ec",{namedCurve:"secp256k1"});case"ES384":return d("ec",{namedCurve:"P-384"});case"ES512":return d("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==t?void 0:t.crv){case void 0:case"Ed25519":return d("ed25519");case"Ed448":return d("ed448");default:throw new s.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let i=null!==(a=null==t?void 0:t.crv)&&void 0!==a?a:"P-256";switch(i){case void 0:case"P-256":case"P-384":case"P-521":return d("ec",{namedCurve:i});case"X25519":return d("x25519");case"X448":return d("x448");default:throw new s.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new s.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}t.generateSecret=c,t.generateKeyPair=l},92031:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setCurve=t.weakMap=void 0;let a=r(14300),i=r(6113),n=r(96904),o=r(81501),s=r(50019),d=r(79176),c=r(51790),l=a.Buffer.from([42,134,72,206,61,3,1,7]),u=a.Buffer.from([43,129,4,0,34]),p=a.Buffer.from([43,129,4,0,35]),f=a.Buffer.from([43,129,4,0,10]);t.weakMap=new WeakMap;let h=e=>{switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new n.JOSENotSupported("Unsupported key curve for this operation")}},y=(e,r)=>{var a;let m;if((0,o.isCryptoKey)(e))m=i.KeyObject.from(e);else if((0,s.default)(e))m=e;else throw TypeError((0,d.default)(e,...c.types));if("secret"===m.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(m.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${m.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${m.asymmetricKeyType.slice(1)}`;case"ec":{if(t.weakMap.has(m))return t.weakMap.get(m);let e=null===(a=m.asymmetricKeyDetails)||void 0===a?void 0:a.namedCurve;if(e||"private"!==m.type){if(!e){let t=m.export({format:"der",type:"spki"}),r=t[1]<128?14:15,a=t[r],i=t.slice(r+1,r+1+a);if(i.equals(l))e="prime256v1";else if(i.equals(u))e="secp384r1";else if(i.equals(p))e="secp521r1";else if(i.equals(f))e="secp256k1";else throw new n.JOSENotSupported("Unsupported key curve for this operation")}}else e=y((0,i.createPublicKey)(m),!0);if(r)return e;let o=h(e);return t.weakMap.set(m,o),o}default:throw TypeError("Invalid asymmetric key type for this operation")}};t.setCurve=function(e,r){t.weakMap.set(e,r)},t.default=y},50975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),i=r(81501),n=r(74637),o=r(79176),s=r(51790);t.default=function(e,t,r){if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw TypeError((0,o.default)(t,...s.types));return(0,a.createSecretKey)(t)}if(t instanceof a.KeyObject)return t;if((0,i.isCryptoKey)(t))return(0,n.checkSigCryptoKey)(t,e,r),a.KeyObject.from(t);throw TypeError((0,o.default)(t,...s.types,"Uint8Array"))}},82526:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(96904);t.default=function(e){switch(e){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new a.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},51790:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.types=void 0;let a=r(81501),i=r(50019);t.default=e=>(0,i.default)(e)||(0,a.isCryptoKey)(e);let n=["KeyObject"];t.types=n,(globalThis.CryptoKey||(null===a.default||void 0===a.default?void 0:a.default.CryptoKey))&&n.push("CryptoKey")},50019:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),i=r(73837);t.default=i.types.isKeyObject?e=>i.types.isKeyObject(e):e=>null!=e&&e instanceof a.KeyObject},44557:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(14300),i=r(6113),n=r(40049),o=r(96904),s=r(92031),d=r(70052),c=r(35725),l=r(19440);t.default=e=>{if(l.jwkImport&&"oct"!==e.kty)return e.d?(0,i.createPrivateKey)({format:"jwk",key:e}):(0,i.createPublicKey)({format:"jwk",key:e});switch(e.kty){case"oct":return(0,i.createSecretKey)((0,n.decode)(e.k));case"RSA":{let t=new c.default,r=void 0!==e.d,n=a.Buffer.from(e.n,"base64"),o=a.Buffer.from(e.e,"base64");r?(t.zero(),t.unsignedInteger(n),t.unsignedInteger(o),t.unsignedInteger(a.Buffer.from(e.d,"base64")),t.unsignedInteger(a.Buffer.from(e.p,"base64")),t.unsignedInteger(a.Buffer.from(e.q,"base64")),t.unsignedInteger(a.Buffer.from(e.dp,"base64")),t.unsignedInteger(a.Buffer.from(e.dq,"base64")),t.unsignedInteger(a.Buffer.from(e.qi,"base64"))):(t.unsignedInteger(n),t.unsignedInteger(o));let s=t.end(),l={key:s,format:"der",type:"pkcs1"},u=r?(0,i.createPrivateKey)(l):(0,i.createPublicKey)(l);return(0,d.setModulusLength)(u,n.length<<3),u}case"EC":{let t=new c.default,r=void 0!==e.d,n=a.Buffer.concat([a.Buffer.alloc(1,4),a.Buffer.from(e.x,"base64"),a.Buffer.from(e.y,"base64")]);if(r){t.zero();let r=new c.default;r.oidFor("ecPublicKey"),r.oidFor(e.crv),t.add(r.end());let o=new c.default;o.one(),o.octStr(a.Buffer.from(e.d,"base64"));let d=new c.default;d.bitStr(n);let l=d.end(a.Buffer.from([161]));o.add(l);let u=o.end(),p=new c.default;p.add(u);let f=p.end(a.Buffer.from([4]));t.add(f);let h=t.end(),y=(0,i.createPrivateKey)({key:h,format:"der",type:"pkcs8"});return(0,s.setCurve)(y,e.crv),y}let o=new c.default;o.oidFor("ecPublicKey"),o.oidFor(e.crv),t.add(o.end()),t.bitStr(n);let d=t.end(),l=(0,i.createPublicKey)({key:d,format:"der",type:"spki"});return(0,s.setCurve)(l,e.crv),l}case"OKP":{let t=new c.default,r=void 0!==e.d;if(r){t.zero();let r=new c.default;r.oidFor(e.crv),t.add(r.end());let n=new c.default;n.octStr(a.Buffer.from(e.d,"base64"));let o=n.end(a.Buffer.from([4]));t.add(o);let s=t.end();return(0,i.createPrivateKey)({key:s,format:"der",type:"pkcs8"})}let n=new c.default;n.oidFor(e.crv),t.add(n.end()),t.bitStr(a.Buffer.from(e.x,"base64"));let o=t.end();return(0,i.createPublicKey)({key:o,format:"der",type:"spki"})}default:throw new o.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}}},40752:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),i=r(40049),n=r(21026),o=r(96904),s=r(92031),d=r(81501),c=r(50019),l=r(79176),u=r(51790),p=r(19440),f=e=>{let t;if((0,d.isCryptoKey)(e)){if(!e.extractable)throw TypeError("CryptoKey is not extractable");t=a.KeyObject.from(e)}else if((0,c.default)(e))t=e;else if(e instanceof Uint8Array)return{kty:"oct",k:(0,i.encode)(e)};else throw TypeError((0,l.default)(e,...u.types,"Uint8Array"));if(p.jwkExport){if("secret"!==t.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(t.asymmetricKeyType))throw new o.JOSENotSupported("Unsupported key asymmetricKeyType");return t.export({format:"jwk"})}switch(t.type){case"secret":return{kty:"oct",k:(0,i.encode)(t.export())};case"private":case"public":switch(t.asymmetricKeyType){case"rsa":{let e;let r=t.export({format:"der",type:"pkcs1"}),a=new n.default(r);"private"===t.type&&a.unsignedInteger();let o=(0,i.encode)(a.unsignedInteger()),s=(0,i.encode)(a.unsignedInteger());return"private"===t.type&&(e={d:(0,i.encode)(a.unsignedInteger()),p:(0,i.encode)(a.unsignedInteger()),q:(0,i.encode)(a.unsignedInteger()),dp:(0,i.encode)(a.unsignedInteger()),dq:(0,i.encode)(a.unsignedInteger()),qi:(0,i.encode)(a.unsignedInteger())}),a.end(),{kty:"RSA",n:o,e:s,...e}}case"ec":{let e,r,n;let d=(0,s.default)(t);switch(d){case"secp256k1":e=64,r=33,n=-1;break;case"P-256":e=64,r=36,n=-1;break;case"P-384":e=96,r=35,n=-3;break;case"P-521":e=132,r=35,n=-3;break;default:throw new o.JOSENotSupported("Unsupported curve")}if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"EC",crv:d,x:(0,i.encode)(r.subarray(-e,-e/2)),y:(0,i.encode)(r.subarray(-e/2))}}let c=t.export({type:"pkcs8",format:"der"});return c.length<100&&(r+=n),{...f((0,a.createPublicKey)(t)),d:(0,i.encode)(c.subarray(r,r+e/2))}}case"ed25519":case"x25519":{let e=(0,s.default)(t);if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"OKP",crv:e,x:(0,i.encode)(r.subarray(-32))}}let r=t.export({type:"pkcs8",format:"der"});return{...f((0,a.createPublicKey)(t)),d:(0,i.encode)(r.subarray(-32))}}case"ed448":case"x448":{let e=(0,s.default)(t);if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"OKP",crv:e,x:(0,i.encode)(r.subarray("Ed448"===e?-57:-56))}}let r=t.export({type:"pkcs8",format:"der"});return{...f((0,a.createPublicKey)(t)),d:(0,i.encode)(r.subarray("Ed448"===e?-57:-56))}}default:throw new o.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new o.JOSENotSupported("Unsupported key type")}};t.default=f},83678:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),i=r(92031),n=r(96904),o=r(70052),s=r(19440),d={padding:a.constants.RSA_PKCS1_PSS_PADDING,saltLength:a.constants.RSA_PSS_SALTLEN_DIGEST},c=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);t.default=function(e,t){switch(e){case"EdDSA":if(!["ed25519","ed448"].includes(t.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return t;case"RS256":case"RS384":case"RS512":if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,o.default)(t,e),t;case s.rsaPssParams&&"PS256":case s.rsaPssParams&&"PS384":case s.rsaPssParams&&"PS512":if("rsa-pss"===t.asymmetricKeyType){let{hashAlgorithm:r,mgf1HashAlgorithm:a,saltLength:i}=t.asymmetricKeyDetails,n=parseInt(e.slice(-3),10);if(void 0!==r&&(r!==`sha${n}`||a!==r))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}`);if(void 0!==i&&i>n>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}`)}else if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return(0,o.default)(t,e),{key:t,...d};case!s.rsaPssParams&&"PS256":case!s.rsaPssParams&&"PS384":case!s.rsaPssParams&&"PS512":if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,o.default)(t,e),{key:t,...d};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let r=(0,i.default)(t),a=c.get(e);if(r!==a)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${a}, got ${r}`);return{dsaEncoding:"ieee-p1363",key:t}}default:throw new n.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}},71760:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;let a=r(73837),i=r(6113),n=r(25131),o=r(27610),s=r(40049),d=r(80015),c=r(78902),l=r(81501),u=r(74637),p=r(50019),f=r(79176),h=r(51790),y=(0,a.promisify)(i.pbkdf2);function m(e,t){if((0,p.default)(e))return e.export();if(e instanceof Uint8Array)return e;if((0,l.isCryptoKey)(e))return(0,u.checkEncCryptoKey)(e,t,"deriveBits","deriveKey"),i.KeyObject.from(e).export();throw TypeError((0,f.default)(e,...h.types,"Uint8Array"))}let w=async(e,t,r,a=2048,i=(0,n.default)(new Uint8Array(16)))=>{(0,c.default)(i);let l=(0,o.p2s)(e,i),u=parseInt(e.slice(13,16),10)>>3,p=m(t,e),f=await y(p,l,a,u,`sha${e.slice(8,11)}`),h=await (0,d.wrap)(e.slice(-6),f,r);return{encryptedKey:h,p2c:a,p2s:(0,s.encode)(i)}};t.encrypt=w;let g=async(e,t,r,a,i)=>{(0,c.default)(i);let n=(0,o.p2s)(e,i),s=parseInt(e.slice(13,16),10)>>3,l=m(t,e),u=await y(l,n,a,s,`sha${e.slice(8,11)}`);return(0,d.unwrap)(e.slice(-6),u,r)};t.decrypt=g},25131:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(6113);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.randomFillSync}})},15368:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;let a=r(6113),i=r(70052),n=r(81501),o=r(74637),s=r(50019),d=r(79176),c=r(51790),l=(e,t)=>{if("rsa"!==e.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,i.default)(e,t)},u=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return a.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return a.constants.RSA_PKCS1_PADDING;default:return}},p=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function f(e,t,...r){if((0,s.default)(e))return e;if((0,n.isCryptoKey)(e))return(0,o.checkEncCryptoKey)(e,t,...r),a.KeyObject.from(e);throw TypeError((0,d.default)(e,...c.types))}t.encrypt=(e,t,r)=>{let i=u(e),n=p(e),o=f(t,e,"wrapKey","encrypt");return l(o,e),(0,a.publicEncrypt)({key:o,oaepHash:n,padding:i},r)},t.decrypt=(e,t,r)=>{let i=u(e),n=p(e),o=f(t,e,"unwrapKey","decrypt");return l(o,e),(0,a.privateDecrypt)({key:o,oaepHash:n,padding:i},r)}},90190:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default="node:crypto"},69030:(e,t,r)=>{let a;Object.defineProperty(t,"__esModule",{value:!0});let i=r(6113),n=r(73837),o=r(96324),s=r(82526),d=r(83678),c=r(50975);a=i.sign.length>3?(0,n.promisify)(i.sign):i.sign;let l=async(e,t,r)=>{let n=(0,c.default)(e,t,"sign");if(e.startsWith("HS")){let t=i.createHmac((0,s.default)(e),n);return t.update(r),t.digest()}return a((0,o.default)(e),r,(0,d.default)(e,n))};t.default=l},4820:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),i=a.timingSafeEqual;t.default=i},76821:(e,t,r)=>{let a;Object.defineProperty(t,"__esModule",{value:!0});let i=r(6113),n=r(73837),o=r(96324),s=r(83678),d=r(69030),c=r(50975),l=r(19440);a=i.verify.length>4&&l.oneShotCallback?(0,n.promisify)(i.verify):i.verify;let u=async(e,t,r,n)=>{let l=(0,c.default)(e,t,"verify");if(e.startsWith("HS")){let t=await (0,d.default)(e,l,n);try{return i.timingSafeEqual(r,t)}catch{return!1}}let u=(0,o.default)(e),p=(0,s.default)(e,l);try{return await a(u,n,p,r)}catch{return!1}};t.default=u},81501:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCryptoKey=void 0;let a=r(6113),i=r(73837),n=a.webcrypto;t.default=n,t.isCryptoKey=i.types.isCryptoKey?e=>i.types.isCryptoKey(e):e=>!1},19868:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deflate=t.inflate=void 0;let a=r(73837),i=r(59796),n=r(96904),o=(0,a.promisify)(i.inflateRaw),s=(0,a.promisify)(i.deflateRaw);t.inflate=e=>o(e,{maxOutputLength:25e4}).catch(()=>{throw new n.JWEDecompressionFailed}),t.deflate=e=>s(e)},59829:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=void 0;let a=r(40049);t.encode=a.encode,t.decode=a.decode},92114:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decodeJwt=void 0;let a=r(59829),i=r(27610),n=r(65171),o=r(96904);t.decodeJwt=function(e){let t,r;if("string"!=typeof e)throw new o.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:s,length:d}=e.split(".");if(5===d)throw new o.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==d)throw new o.JWTInvalid("Invalid JWT");if(!s)throw new o.JWTInvalid("JWTs must contain a payload");try{t=(0,a.decode)(s)}catch{throw new o.JWTInvalid("Failed to base64url decode the payload")}try{r=JSON.parse(i.decoder.decode(t))}catch{throw new o.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,n.default)(r))throw new o.JWTInvalid("Invalid JWT Claims Set");return r}},2785:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decodeProtectedHeader=void 0;let a=r(59829),i=r(27610),n=r(65171);t.decodeProtectedHeader=function(e){let t;if("string"==typeof e){let r=e.split(".");(3===r.length||5===r.length)&&([t]=r)}else if("object"==typeof e&&e){if("protected"in e)t=e.protected;else throw TypeError("Token does not contain a Protected Header")}try{if("string"!=typeof t||!t)throw Error();let e=JSON.parse(i.decoder.decode((0,a.decode)(t)));if(!(0,n.default)(e))throw Error();return e}catch{throw TypeError("Invalid Token or Protected Header formatting")}}},96904:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JWSSignatureVerificationFailed=t.JWKSTimeout=t.JWKSMultipleMatchingKeys=t.JWKSNoMatchingKey=t.JWKSInvalid=t.JWKInvalid=t.JWTInvalid=t.JWSInvalid=t.JWEInvalid=t.JWEDecompressionFailed=t.JWEDecryptionFailed=t.JOSENotSupported=t.JOSEAlgNotAllowed=t.JWTExpired=t.JWTClaimValidationFailed=t.JOSEError=void 0;class r extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,this,this.constructor)}}t.JOSEError=r,t.JWTClaimValidationFailed=class extends r{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}},t.JWTExpired=class extends r{static get code(){return"ERR_JWT_EXPIRED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=t,this.reason=r}},t.JOSEAlgNotAllowed=class extends r{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}},t.JOSENotSupported=class extends r{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}},t.JWEDecryptionFailed=class extends r{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}},t.JWEDecompressionFailed=class extends r{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}},t.JWEInvalid=class extends r{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}},t.JWSInvalid=class extends r{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}},t.JWTInvalid=class extends r{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}},t.JWKInvalid=class extends r{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}},t.JWKSInvalid=class extends r{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}},t.JWKSNoMatchingKey=class extends r{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}},t.JWKSMultipleMatchingKeys=class extends r{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}},Symbol.asyncIterator,t.JWKSTimeout=class extends r{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}},t.JWSSignatureVerificationFailed=class extends r{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}},34174:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let a=r(90190);t.default=a.default},74418:e=>{var t={decodeValues:!0,map:!1,silent:!1};function r(e){return"string"==typeof e&&!!e.trim()}function a(e,a){var i,n,o,s,d=e.split(";").filter(r),c=(i=d.shift(),n="",o="",(s=i.split("=")).length>1?(n=s.shift(),o=s.join("=")):o=i,{name:n,value:o}),l=c.name,u=c.value;a=a?Object.assign({},t,a):t;try{u=a.decodeValues?decodeURIComponent(u):u}catch(e){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+u+"'. Set options.decodeValues to false to disable this feature.",e)}var p={name:l,value:u};return d.forEach(function(e){var t=e.split("="),r=t.shift().trimLeft().toLowerCase(),a=t.join("=");"expires"===r?p.expires=new Date(a):"max-age"===r?p.maxAge=parseInt(a,10):"secure"===r?p.secure=!0:"httponly"===r?p.httpOnly=!0:"samesite"===r?p.sameSite=a:"partitioned"===r?p.partitioned=!0:p[r]=a}),p}function i(e,i){if(i=i?Object.assign({},t,i):t,!e)return i.map?{}:[];if(e.headers){if("function"==typeof e.headers.getSetCookie)e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var n=e.headers[Object.keys(e.headers).find(function(e){return"set-cookie"===e.toLowerCase()})];n||!e.headers.cookie||i.silent||console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=n}}return(Array.isArray(e)||(e=[e]),i.map)?e.filter(r).reduce(function(e,t){var r=a(t,i);return e[r.name]=r,e},{}):e.filter(r).map(function(e){return a(e,i)})}e.exports=i,e.exports.parse=i,e.exports.parseString=a,e.exports.splitCookiesString=function(e){if(Array.isArray(e))return e;if("string"!=typeof e)return[];var t,r,a,i,n,o=[],s=0;function d(){for(;s<e.length&&/\s/.test(e.charAt(s));)s+=1;return s<e.length}for(;s<e.length;){for(t=s,n=!1;d();)if(","===(r=e.charAt(s))){for(a=s,s+=1,d(),i=s;s<e.length&&"="!==(r=e.charAt(s))&&";"!==r&&","!==r;)s+=1;s<e.length&&"="===e.charAt(s)?(n=!0,s=i,o.push(e.substring(t,a)),t=s):s=a+1}else s+=1;(!n||s>=e.length)&&o.push(e.substring(t,e.length))}return o}}};